{"version":3,"file":"slimselect.iife.js","sources":["../src/slim-select/classes.ts","../src/slim-select/helpers.ts","../src/slim-select/store.ts","../src/slim-select/render.ts","../src/slim-select/select.ts","../src/slim-select/settings.ts","../src/slim-select/index.ts","../src/slim-select/index.umd.ts"],"sourcesContent":["export default class CssClasses {\r\n  public main: string\r\n  // Placeholder\r\n  public placeholder: string\r\n\r\n  // Values\r\n  public values: string\r\n  public single: string\r\n  public max: string\r\n  public value: string\r\n  public valueText: string\r\n  public valueDelete: string\r\n  public valueOut: string\r\n\r\n  // Deselect\r\n  public deselect: string\r\n  public deselectPath: string // Not a class but whatever\r\n\r\n  // Arrow\r\n  public arrow: string\r\n  public arrowClose: string // Not a class but whatever\r\n  public arrowOpen: string // Not a class but whatever\r\n\r\n  // Content\r\n  public content: string\r\n  public contentOpen: string\r\n  public dirAbove: string\r\n  public dirBelow: string\r\n\r\n  // Search\r\n  public search: string\r\n  public searchHighlighter: string\r\n  public searching: string\r\n  public addable: string\r\n  public addablePath: string // Not a class but whatever\r\n  public addButton: string\r\n  public addButtonPath: string // Not a class but whatever\r\n\r\n  // List optgroups/options\r\n  public list: string\r\n\r\n  // Optgroup\r\n  public optgroup: string\r\n  public optgroupLabel: string\r\n  public optgroupLabelText: string\r\n  public optgroupActions: string\r\n  public optgroupSelectAll: string // optgroup select all\r\n  public optgroupSelectAllBox: string // Not a class but whatever\r\n  public optgroupSelectAllCheck: string // Not a class but whatever\r\n  public optgroupClosable: string\r\n\r\n  // Option\r\n  public option: string\r\n  public optionDelete: string // Not a class but whatever\r\n  public highlighted: string\r\n\r\n  // Misc\r\n  public mainOpen: string\r\n  public close: string\r\n  public selected: string\r\n  public error: string\r\n  public disabled: string\r\n  public hide: string\r\n\r\n  constructor(classes?: Partial<CssClasses>) {\r\n    if (!classes) {\r\n      classes = {}\r\n    }\r\n\r\n    let join = (a = '', b = '') => `${a} ${b}`.trim()\r\n\r\n    this.main = join('ss-main', classes.main)\r\n    this.placeholder = join('ss-placeholder', classes.placeholder)\r\n    this.values = join('ss-values', classes.values)\r\n    this.single = join('ss-single', classes.single)\r\n    this.max = join('ss-max', classes.max)\r\n    this.value = join('ss-value', classes.value)\r\n    this.valueText = join('ss-value-text', classes.valueText)\r\n    this.valueDelete = join('ss-value-delete', classes.valueDelete)\r\n    this.valueOut = join('ss-value-out', classes.valueOut)\r\n\r\n    this.deselect = join('ss-deselect', classes.deselect)\r\n    this.deselectPath = classes.deselectPath || 'M10,10 L90,90 M10,90 L90,10'\r\n    this.arrow = join('ss-arrow', classes.arrow)\r\n    this.arrowClose = classes.arrowClose || 'M10,30 L50,70 L90,30'\r\n    this.arrowOpen = classes.arrowOpen || 'M10,70 L50,30 L90,70'\r\n    this.content = join('ss-content', classes.content)\r\n    this.contentOpen = join('ss-open', classes.contentOpen)\r\n    this.dirAbove = join('ss-dir-above', classes.dirAbove)\r\n    this.dirBelow = join('ss-dir-below', classes.dirBelow)\r\n    this.search = join('ss-search', classes.search)\r\n    this.searchHighlighter = join('ss-search-highlight', classes.searchHighlighter)\r\n    this.searching = join('ss-searching', classes.searching)\r\n    this.addable = join('ss-addable', classes.addable)\r\n    this.addablePath = classes.addablePath || 'M50,10 L50,90 M10,50 L90,50'\r\n    this.addButton = join('ss-add-button', classes.addButton)\r\n    this.addButtonPath = classes.addButtonPath || 'M50,10 L50,90 M10,50 L90,50'\r\n    this.list = join('ss-list', classes.list)\r\n    this.optgroup = join('ss-optgroup', classes.optgroup)\r\n    this.optgroupLabel = join('ss-optgroup-label', classes.optgroupLabel)\r\n    this.optgroupLabelText = join('ss-optgroup-label-text', classes.optgroupLabelText)\r\n    this.optgroupActions = join('ss-optgroup-actions', classes.optgroupActions)\r\n    this.optgroupSelectAll = join('ss-selectall', classes.optgroupSelectAll)\r\n    this.optgroupSelectAllBox = classes.optgroupSelectAllBox || 'M60,10 L10,10 L10,90 L90,90 L90,50'\r\n    this.optgroupSelectAllCheck = classes.optgroupSelectAllCheck || 'M30,45 L50,70 L90,10'\r\n    this.optgroupClosable = join('ss-closable', classes.optgroupClosable)\r\n    this.option = join('ss-option', classes.option)\r\n    this.optionDelete = classes.optionDelete || 'M10,10 L90,90 M10,90 L90,10'\r\n    this.highlighted = join('ss-highlighted', classes.highlighted)\r\n    this.mainOpen = join('ss-open', classes.mainOpen)\r\n    this.close = join('ss-close', classes.close)\r\n    this.selected = join('ss-selected', classes.selected)\r\n    this.error = join('ss-error', classes.error)\r\n    this.disabled = join('ss-disabled', classes.disabled)\r\n    this.hide = join('ss-hide', classes.hide)\r\n  }\r\n\r\n  public getFirst(name: keyof Omit<CssClasses, 'getFirst'>): string {\r\n    return this[name].split(' ')[0]\r\n  }\r\n}\r\n","// Generate an 8 character random string\r\nexport function generateID(): string {\r\n  return Math.random().toString(36).substring(2, 10)\r\n}\r\n\r\nexport function hasClassInTree(element: HTMLElement, className: string): HTMLElement | null {\r\n  function hasClass(e: HTMLElement, c: string) {\r\n    // If the element has the class return element\r\n    if (c && e && e.classList && e.classList.contains(c)) {\r\n      return e\r\n    }\r\n\r\n    // If the element has a dataset id of the class return element\r\n    if (c && e && e.dataset && e.dataset.id && e.dataset.id === className) {\r\n      return e\r\n    }\r\n\r\n    return null\r\n  }\r\n\r\n  function parentByClass(e: any, c: string): any {\r\n    if (!e || e === (document as any)) {\r\n      return null\r\n    } else if (hasClass(e, c)) {\r\n      return e\r\n    } else {\r\n      return parentByClass(e.parentNode, c)\r\n    }\r\n  }\r\n\r\n  return hasClass(element, className) || parentByClass(element, className)\r\n}\r\n\r\n// debounce will call the last requested function after the wait time\r\nexport function debounce<T extends (...args: any[]) => void>(func: T, wait = 50, immediate = false): () => void {\r\n  let timeout: any\r\n  return function (this: any, ...args: any[]): void {\r\n    const context = self\r\n    const later = () => {\r\n      timeout = null\r\n      if (!immediate) {\r\n        func.apply(context, args)\r\n      }\r\n    }\r\n    const callNow = immediate && !timeout\r\n    clearTimeout(timeout)\r\n    timeout = setTimeout(later, wait)\r\n    if (callNow) {\r\n      func.apply(context, args)\r\n    }\r\n  }\r\n}\r\n\r\nexport function isEqual(a: any, b: any): boolean {\r\n  return JSON.stringify(a) === JSON.stringify(b)\r\n}\r\n\r\nexport function kebabCase(str: string): string {\r\n  const result = str.replace(/[A-Z\\u00C0-\\u00D6\\u00D8-\\u00DE]/g, (match) => '-' + match.toLowerCase())\r\n  return str[0] === str[0].toUpperCase() ? result.substring(1) : result\r\n}\r\n","import { generateID } from './helpers'\r\n\r\nexport class Option {\r\n  id: string\r\n  value: string\r\n  text: string\r\n  html: string\r\n  defaultSelected: boolean\r\n  selected: boolean\r\n  display: boolean\r\n  disabled: boolean\r\n  placeholder: boolean\r\n  class: string\r\n  style: string\r\n  data: { [key: string]: string }\r\n  mandatory: boolean\r\n\r\n  constructor(option: Partial<Option>) {\r\n    this.id = !option.id || option.id === '' ? generateID() : option.id\r\n    this.value = option.value === undefined ? option.text || '' : option.value || ''\r\n    this.text = option.text || ''\r\n    this.html = option.html || ''\r\n    this.defaultSelected = option.defaultSelected !== undefined ? option.defaultSelected : false\r\n    this.selected = option.selected !== undefined ? option.selected : false\r\n    this.display = option.display !== undefined ? option.display : true\r\n    this.disabled = option.disabled !== undefined ? option.disabled : false\r\n    this.mandatory = option.mandatory !== undefined ? option.mandatory : false\r\n    this.placeholder = option.placeholder !== undefined ? option.placeholder : false\r\n    this.class = option.class || ''\r\n    this.style = option.style || ''\r\n    this.data = option.data || {}\r\n  }\r\n}\r\nexport class Optgroup {\r\n  public id: string\r\n  public label: string\r\n  public selectAll: boolean\r\n  public selectAllText: string\r\n  public closable: 'off' | 'open' | 'close'\r\n  public options: Partial<Option>[]\r\n\r\n  constructor(optgroup: Partial<Optgroup>) {\r\n    this.id = !optgroup.id || optgroup.id === '' ? generateID() : optgroup.id\r\n    this.label = optgroup.label || ''\r\n    this.selectAll = optgroup.selectAll === undefined ? false : optgroup.selectAll\r\n    this.selectAllText = optgroup.selectAllText || 'Select All'\r\n    this.closable = optgroup.closable || 'off'\r\n\r\n    // If options exist, loop through options and create new option class\r\n    // and set the options to the optgroup options field\r\n    this.options = []\r\n    if (optgroup.options) {\r\n      for (const o of optgroup.options) {\r\n        this.options.push(new Option(o))\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nexport default class Store {\r\n  private selectType: 'single' | 'multiple' = 'single'\r\n\r\n  // Main data set, never null\r\n  private data: (Option | Optgroup)[] = []\r\n  private selectedOrder: string[] = []\r\n\r\n  constructor(type: 'single' | 'multiple', data: (Partial<Option> | Partial<Optgroup>)[]) {\r\n    this.selectType = type\r\n    this.setData(data)\r\n  }\r\n\r\n  // Validate DataArrayPartial\r\n  public validateDataArray(data: (Partial<Option> | Partial<Optgroup>)[]): Error | null {\r\n    if (!Array.isArray(data)) {\r\n      return new Error('Data must be an array')\r\n    }\r\n\r\n    // Loop through each data object\r\n    for (let dataObj of data) {\r\n      if (!dataObj) continue\r\n\r\n      // Optgroup\r\n      if (dataObj instanceof Optgroup || 'label' in dataObj) {\r\n        if (!('label' in dataObj)) {\r\n          return new Error('Optgroup must have a label')\r\n        }\r\n\r\n        if ('options' in dataObj && dataObj.options) {\r\n          for (let option of dataObj.options) {\r\n            const validationError = this.validateOption(option)\r\n            if (validationError) {\r\n              return validationError\r\n            }\r\n          }\r\n        }\r\n      } else if (dataObj instanceof Option || 'text' in dataObj) {\r\n        const validationError = this.validateOption(dataObj)\r\n        if (validationError) {\r\n          return validationError\r\n        }\r\n      } else {\r\n        return new Error('Data object must be a valid optgroup or option')\r\n      }\r\n    }\r\n\r\n    return null\r\n  }\r\n\r\n  // Validate Option\r\n  public validateOption(option: Partial<Option>): Error | null {\r\n    if (!('text' in option)) {\r\n      return new Error('Option must have a text')\r\n    }\r\n\r\n    return null\r\n  }\r\n\r\n  public partialToFullData(data: (Partial<Option> | Partial<Optgroup>)[]): (Option | Optgroup)[] {\r\n    let dataFinal: (Option | Optgroup)[] = []\r\n    data.forEach((dataObj) => {\r\n      if (!dataObj) return\r\n\r\n      // Optgroup\r\n      if (dataObj instanceof Optgroup || 'label' in dataObj) {\r\n        let optOptions: Option[] = []\r\n        if ('options' in dataObj && dataObj.options) {\r\n          dataObj.options.forEach((option: Partial<Option>) => {\r\n            optOptions.push(new Option(option))\r\n          })\r\n        }\r\n\r\n        if (optOptions.length > 0) {\r\n          dataFinal.push(new Optgroup(dataObj as Partial<Optgroup>))\r\n        }\r\n      }\r\n\r\n      // Option\r\n      if (dataObj instanceof Option || 'text' in dataObj) {\r\n        dataFinal.push(new Option(dataObj as Partial<Option>))\r\n      }\r\n    })\r\n\r\n    return dataFinal\r\n  }\r\n\r\n  public setData(data: (Partial<Option> | Partial<Optgroup>)[], preserveSelected: boolean = false) {\r\n    // Convert new data to full data array\r\n    const newData = this.partialToFullData(data)\r\n\r\n    if (preserveSelected) {\r\n      // Get currently selected options before updating data\r\n      const selectedOptions = this.getSelectedOptions()\r\n\r\n      // Check which selected options are missing from new data\r\n      const missingSelected: (Option | Optgroup)[] = []\r\n      selectedOptions.forEach((selectedOption) => {\r\n        let found = false\r\n\r\n        // Check if this selected option exists in new data\r\n        for (const newItem of newData) {\r\n          if (newItem instanceof Option && newItem.id === selectedOption.id) {\r\n            found = true\r\n            break\r\n          }\r\n          if (newItem instanceof Optgroup) {\r\n            for (const opt of newItem.options) {\r\n              if (opt.id === selectedOption.id) {\r\n                found = true\r\n                break\r\n              }\r\n            }\r\n          }\r\n        }\r\n\r\n        if (!found) {\r\n          missingSelected.push(selectedOption)\r\n        }\r\n      })\r\n\r\n      // Add missing selected options to the beginning of the data\r\n      this.data = [...missingSelected, ...newData]\r\n    } else {\r\n      this.data = newData\r\n    }\r\n\r\n    // Run this.data through setSelected by value\r\n    // to set the selected property and clean any wrong selected\r\n    if (this.selectType === 'single') {\r\n      this.setSelectedBy('id', this.getSelected())\r\n    }\r\n  }\r\n\r\n  // Get data will return all the data\r\n  public getData(): Option[] | Optgroup[] {\r\n    return this.filter(null, true) as Option[] | Optgroup[]\r\n  }\r\n\r\n  // Get data options will return the data as a\r\n  // flat array of just options\r\n  public getDataOptions(): Option[] {\r\n    return this.filter(null, false) as Option[]\r\n  }\r\n\r\n  public addOption(option: Partial<Option>, addToStart: boolean = false) {\r\n    if (addToStart) {\r\n      let data = [new Option(option)] as (Option | Optgroup)[]\r\n      this.setData(data.concat(this.getData()))\r\n    } else {\r\n      this.setData(this.getData().concat(new Option(option)))\r\n    }\r\n  }\r\n\r\n  // Pass in an array of id that will loop through\r\n  // each option and set the selected property to true\r\n  // but also clean selected by determining selectType\r\n  public setSelectedBy(selectedType: 'id' | 'value', selectedValues: string[]) {\r\n    let firstOption: Partial<Option> | null = null\r\n    let hasSelected = false\r\n    const selectedObjects: Partial<Option>[] = []\r\n\r\n    for (let dataObj of this.data) {\r\n      // Optgroup\r\n      if (dataObj instanceof Optgroup) {\r\n        for (let option of dataObj.options as Partial<Option>[]) {\r\n          if (!firstOption) {\r\n            firstOption = option\r\n          }\r\n\r\n          let optionValue = option[selectedType] || ''\r\n          option.selected = hasSelected ? false : selectedValues.includes(optionValue)\r\n\r\n          // If the option is selected, set hasSelected to true\r\n          // for single based selects\r\n          if (option.selected) {\r\n            selectedObjects.push(option)\r\n\r\n            if (this.selectType === 'single') {\r\n              hasSelected = true\r\n            }\r\n          }\r\n        }\r\n      }\r\n\r\n      // Option\r\n      if (dataObj instanceof Option) {\r\n        if (!firstOption) {\r\n          firstOption = dataObj\r\n        }\r\n\r\n        dataObj.selected = hasSelected ? false : selectedValues.includes(dataObj[selectedType])\r\n\r\n        // If the option is selected, set hasSelected to true\r\n        // for single based selects\r\n        if (dataObj.selected) {\r\n          selectedObjects.push(dataObj)\r\n\r\n          if (this.selectType === 'single') {\r\n            hasSelected = true\r\n          }\r\n        }\r\n      }\r\n    }\r\n\r\n    // If no options are selected, select the first option\r\n    if (this.selectType === 'single' && firstOption && !hasSelected) {\r\n      firstOption.selected = true\r\n      selectedObjects.push(firstOption)\r\n    }\r\n\r\n    // Put together a list of selected ids in the order of the selected values\r\n    const selectedIds = selectedValues.map((value) => {\r\n      return selectedObjects.find((option) => option[selectedType] === value)?.id || ''\r\n    })\r\n\r\n    this.selectedOrder = selectedIds\r\n  }\r\n\r\n  public getSelected(): string[] {\r\n    return this.getSelectedOptions().map((option) => option.id)\r\n  }\r\n\r\n  public getSelectedValues(): string[] {\r\n    return this.getSelectedOptions().map((option) => option.value)\r\n  }\r\n\r\n  public getSelectedOptions(): Option[] {\r\n    return this.filter((opt: Option) => {\r\n      return opt.selected\r\n    }, false) as Option[]\r\n  }\r\n\r\n  public getOptgroupByID(id: string): Optgroup | null {\r\n    // Loop through each data object\r\n    // and if optgroup is found, return it\r\n    for (let dataObj of this.data) {\r\n      if (dataObj instanceof Optgroup && dataObj.id === id) {\r\n        return dataObj\r\n      }\r\n    }\r\n\r\n    return null\r\n  }\r\n\r\n  public getOptionByID(id: string): Option | null {\r\n    let options = this.filter((opt: Option) => {\r\n      return opt.id === id\r\n    }, false) as Option[]\r\n\r\n    return options.length ? options[0] : null\r\n  }\r\n\r\n  public getSelectType(): string {\r\n    return this.selectType\r\n  }\r\n\r\n  public getFirstOption(): Option | null {\r\n    let option: Option | null = null\r\n    for (let dataObj of this.data) {\r\n      if (dataObj instanceof Optgroup) {\r\n        option = dataObj.options[0] as Option\r\n      } else if (dataObj instanceof Option) {\r\n        option = dataObj\r\n      }\r\n\r\n      if (option) {\r\n        break\r\n      }\r\n    }\r\n    return option\r\n  }\r\n\r\n  // Take in search string and return filtered list of values\r\n  public search(search: string, searchFilter: (opt: Option, search: string) => boolean): (Option | Optgroup)[] {\r\n    search = search.trim()\r\n\r\n    // If search is empty, return all data\r\n    if (search === '') {\r\n      return this.getData()\r\n    }\r\n\r\n    // Run filter with search function\r\n    return this.filter((opt: Option): boolean => {\r\n      return searchFilter(opt, search)\r\n    }, true)\r\n  }\r\n\r\n  // Filter takes in a function that will be used to filter the data\r\n  // This will also keep optgroups of sub options meet the filter requirements\r\n  public filter(filter: { (opt: Option): boolean } | null, includeOptgroup: boolean): (Option | Optgroup)[] {\r\n    const dataSearch: (Option | Optgroup)[] = []\r\n    this.data.forEach((dataObj: Option | Optgroup) => {\r\n      // Optgroup\r\n      if (dataObj instanceof Optgroup) {\r\n        let optOptions: Option[] = []\r\n        let options = dataObj.options as Option[]\r\n        options.forEach((option: Option) => {\r\n          if (!filter || filter(option as Option)) {\r\n            // If you dont want to include optgroups\r\n            // just push to the dataSearch array\r\n            if (!includeOptgroup) {\r\n              dataSearch.push(new Option(option))\r\n            } else {\r\n              optOptions.push(new Option(option))\r\n            }\r\n          }\r\n        })\r\n\r\n        // If we pushed any options to the optOptions array\r\n        // push the optgroup to the dataSearch array\r\n        if (optOptions.length > 0) {\r\n          // Create new optgroup with the new options\r\n          let optgroup = new Optgroup(dataObj)\r\n          optgroup.options = optOptions\r\n\r\n          // Push optgroup to dataSearch\r\n          dataSearch.push(optgroup)\r\n        }\r\n      }\r\n\r\n      // Option\r\n      if (dataObj instanceof Option) {\r\n        if (!filter || filter(dataObj)) {\r\n          dataSearch.push(new Option(dataObj))\r\n        }\r\n      }\r\n    })\r\n\r\n    return dataSearch\r\n  }\r\n\r\n  // Take in an array of options and reoder them based upon the selected order\r\n  public selectedOrderOptions(options: Option[]): Option[] {\r\n    const newOrder: Option[] = []\r\n    this.selectedOrder.forEach((id) => {\r\n      const option = options.find((opt) => opt.id === id)\r\n      if (option) {\r\n        newOrder.push(option)\r\n      }\r\n    })\r\n\r\n    // add any remaining options that were not in the selected order\r\n    options.forEach((option) => {\r\n      let isIn = false\r\n      newOrder.forEach((selectedOption) => {\r\n        if (option.id === selectedOption.id) {\r\n          isIn = true\r\n\r\n          return\r\n        }\r\n      })\r\n\r\n      if (!isIn) {\r\n        newOrder.push(option)\r\n      }\r\n    })\r\n\r\n    return newOrder\r\n  }\r\n}\r\n","import { debounce } from './helpers'\r\nimport Settings from './settings'\r\nimport Store, { Optgroup, Option } from './store'\r\nimport CssClasses from './classes'\r\n\r\nexport interface Callbacks {\r\n  open: () => void\r\n  close: () => void\r\n  addable?: (\r\n    value: string\r\n  ) => Promise<Partial<Option> | string> | Partial<Option> | string | false | undefined | null | Error\r\n  addButton?: () => void\r\n  setSelected: (value: string | string[], runAfterChange: boolean) => void\r\n  addOption: (option: Option) => void\r\n  search: (search: string) => void\r\n  beforeChange?: (newVal: Option[], oldVal: Option[]) => boolean | void\r\n  afterChange?: (newVal: Option[]) => void\r\n}\r\n\r\nexport interface Main {\r\n  main: HTMLDivElement\r\n  values: HTMLDivElement\r\n  deselect: {\r\n    main: HTMLDivElement\r\n    svg: SVGSVGElement\r\n    path: SVGPathElement\r\n  }\r\n  arrow: {\r\n    main: SVGSVGElement\r\n    path: SVGPathElement\r\n  }\r\n}\r\n\r\nexport interface Content {\r\n  main: HTMLDivElement\r\n  search: Search\r\n  list: HTMLDivElement\r\n  addButton?: AddButton\r\n}\r\n\r\nexport interface AddButton {\r\n  main: HTMLDivElement\r\n  svg: SVGSVGElement\r\n  path: SVGPathElement\r\n  text?: HTMLSpanElement\r\n}\r\n\r\nexport interface Search {\r\n  main: HTMLDivElement\r\n  input: HTMLInputElement\r\n  addable?: {\r\n    main: HTMLDivElement\r\n    svg: SVGSVGElement\r\n    path: SVGPathElement\r\n  }\r\n}\r\n\r\nexport default class Render {\r\n  public settings: Settings\r\n  public store: Store\r\n  public callbacks: Callbacks\r\n\r\n  // Used to compute the range selection\r\n  private lastSelectedOption: Option | null\r\n\r\n  // Timeout tracking for cleanup\r\n  private closeAnimationTimeout: ReturnType<typeof setTimeout> | null = null\r\n\r\n  // Elements\r\n  public main: Main\r\n  public content: Content\r\n\r\n  // Classes\r\n  public classes: CssClasses\r\n\r\n  constructor(settings: Required<Settings>, classes: Required<CssClasses>, store: Store, callbacks: Callbacks) {\r\n    this.store = store\r\n    this.settings = settings\r\n    this.classes = classes\r\n    this.callbacks = callbacks\r\n    this.lastSelectedOption = null\r\n\r\n    this.main = this.mainDiv()\r\n    this.content = this.contentDiv()\r\n\r\n    // Add classes and styles to main/content\r\n    this.updateClassStyles()\r\n    this.updateAriaAttributes()\r\n\r\n    // Position content off-screen initially to prevent scrollbars\r\n    // This must be after updateClassStyles() since it removes all style attributes\r\n    // The main element isn't in the DOM yet, so getBoundingClientRect() would return zeros\r\n    // Once opened, moveContent() will position it correctly\r\n    if (this.settings.contentPosition !== 'relative') {\r\n      this.content.main.style.top = '-9999px'\r\n      this.content.main.style.left = '-9999px'\r\n      this.content.main.style.margin = '0'\r\n      this.content.main.style.width = 'auto'\r\n    }\r\n\r\n    // Add content to the content location settings\r\n    if (this.settings.contentLocation) {\r\n      this.settings.contentLocation.appendChild(this.content.main)\r\n    }\r\n  }\r\n\r\n  // Helper method to add classes that may contain spaces\r\n  // Splits by spaces and adds each class individually to avoid DOMException\r\n  private addClasses(element: HTMLElement | SVGElement, classValue: string): void {\r\n    if (!classValue || classValue.trim() === '') {\r\n      return\r\n    }\r\n    const classes = classValue.split(' ').filter((c) => c.trim() !== '')\r\n    for (const cls of classes) {\r\n      element.classList.add(cls.trim())\r\n    }\r\n  }\r\n\r\n  // Helper method to remove classes that may contain spaces\r\n  private removeClasses(element: HTMLElement | SVGElement, classValue: string): void {\r\n    if (!classValue || classValue.trim() === '') {\r\n      return\r\n    }\r\n    const classes = classValue.split(' ').filter((c) => c.trim() !== '')\r\n    for (const cls of classes) {\r\n      element.classList.remove(cls.trim())\r\n    }\r\n  }\r\n\r\n  // Remove disabled classes\r\n  public enable(): void {\r\n    // Remove disabled class\r\n    this.removeClasses(this.main.main, this.classes.disabled)\r\n    this.main.main.setAttribute('aria-disabled', 'false')\r\n\r\n    // Set search input to \"enabled\"\r\n    this.content.search.input.disabled = false\r\n  }\r\n\r\n  // Set disabled classes\r\n  public disable(): void {\r\n    // Add disabled class\r\n    this.addClasses(this.main.main, this.classes.disabled)\r\n    this.main.main.setAttribute('aria-disabled', 'true')\r\n\r\n    // Set search input to disabled\r\n    this.content.search.input.disabled = true\r\n  }\r\n\r\n  public open(): void {\r\n    this.main.arrow.path.setAttribute('d', this.classes.arrowOpen)\r\n    this.main.main.setAttribute('aria-expanded', 'true')\r\n\r\n    // Clear any pending close animation timeout to prevent race conditions\r\n    if (this.closeAnimationTimeout) {\r\n      clearTimeout(this.closeAnimationTimeout)\r\n      this.closeAnimationTimeout = null\r\n    }\r\n\r\n    // Set direction class on both main and content (persists, never removed)\r\n    const isAbove = this.settings.openPosition === 'up'\r\n    const dirClass = isAbove ? this.classes.dirAbove : this.classes.dirBelow\r\n    this.addClasses(this.main.main, dirClass)\r\n    this.addClasses(this.content.main, dirClass)\r\n\r\n    // Add open class to content to trigger open animation\r\n    this.addClasses(this.content.main, this.classes.contentOpen)\r\n\r\n    // Make search visible to screen readers when opened\r\n    this.content.search.input.removeAttribute('aria-hidden')\r\n\r\n    // move the content in to the right location\r\n    this.moveContent()\r\n\r\n    // Move to last selected option\r\n    const selectedOptions = this.store.getSelectedOptions()\r\n    if (selectedOptions.length) {\r\n      const selectedId = selectedOptions[selectedOptions.length - 1].id\r\n      const selectedOption = this.content.list.querySelector('[data-id=\"' + selectedId + '\"]') as HTMLElement\r\n      if (selectedOption) {\r\n        this.ensureElementInView(this.content.list, selectedOption)\r\n      }\r\n    }\r\n  }\r\n\r\n  public close(): void {\r\n    this.main.main.setAttribute('aria-expanded', 'false')\r\n    this.main.arrow.path.setAttribute('d', this.classes.arrowClose)\r\n\r\n    // Remove open class from content to trigger close animation\r\n    // Direction class (dirAbove/dirBelow) persists to maintain correct transform-origin\r\n    this.removeClasses(this.content.main, this.classes.contentOpen)\r\n\r\n    // Hide search from screen readers when closed\r\n    this.content.search.input.setAttribute('aria-hidden', 'true')\r\n\r\n    // Clear active descendant when closed\r\n    this.main.main.removeAttribute('aria-activedescendant')\r\n\r\n    // Remove direction class from main and content after animation is complete\r\n    const animationTiming = this.getAnimationTiming()\r\n    this.closeAnimationTimeout = setTimeout(() => {\r\n      this.removeClasses(this.main.main, this.classes.dirAbove)\r\n      this.removeClasses(this.main.main, this.classes.dirBelow)\r\n      this.removeClasses(this.content.main, this.classes.dirAbove)\r\n      this.removeClasses(this.content.main, this.classes.dirBelow)\r\n      this.closeAnimationTimeout = null\r\n    }, animationTiming)\r\n  }\r\n\r\n  private getAnimationTiming(): number {\r\n    const computedStyle = getComputedStyle(this.content.main)\r\n    const cssValue = computedStyle.getPropertyValue('--ss-animation-timing').trim()\r\n\r\n    if (cssValue) {\r\n      // Parse CSS time value (e.g., \"0.2s\" or \"200ms\")\r\n      if (cssValue.endsWith('ms')) {\r\n        return parseFloat(cssValue)\r\n      } else if (cssValue.endsWith('s')) {\r\n        return parseFloat(cssValue) * 1000\r\n      }\r\n    }\r\n\r\n    // Fall back to default 200ms\r\n    return 200\r\n  }\r\n\r\n  public updateClassStyles(): void {\r\n    // Clear all classes and styles\r\n    this.main.main.className = ''\r\n    this.main.main.removeAttribute('style')\r\n    this.content.main.className = ''\r\n    this.content.main.removeAttribute('style')\r\n\r\n    // Make sure main/content has its base class\r\n    this.addClasses(this.main.main, this.classes.main)\r\n    this.addClasses(this.content.main, this.classes.content)\r\n\r\n    // Add styles\r\n    if (this.settings.style !== '') {\r\n      this.main.main.style.cssText = this.settings.style\r\n      this.content.main.style.cssText = this.settings.style\r\n    }\r\n\r\n    // Add classes\r\n    if (this.settings.class.length) {\r\n      for (const c of this.settings.class) {\r\n        if (c.trim() !== '') {\r\n          this.main.main.classList.add(c.trim())\r\n          this.content.main.classList.add(c.trim())\r\n        }\r\n      }\r\n    }\r\n\r\n    // Misc classes\r\n    // Add content position class\r\n    if (this.settings.contentPosition === 'relative' || this.settings.contentPosition === 'fixed') {\r\n      this.content.main.classList.add('ss-' + this.settings.contentPosition)\r\n    }\r\n  }\r\n\r\n  public updateAriaAttributes() {\r\n    const listboxId = this.content.list.id\r\n\r\n    // Main combobox\r\n    this.main.main.role = 'combobox'\r\n    this.main.main.setAttribute('aria-haspopup', 'listbox')\r\n    this.main.main.setAttribute('aria-controls', listboxId)\r\n    this.main.main.setAttribute('aria-expanded', 'false')\r\n\r\n    this.content.list.setAttribute('role', 'listbox')\r\n    this.content.list.setAttribute('aria-label', this.settings.ariaLabel + ' listbox')\r\n\r\n    // Add aria-multiselectable for multiple selects\r\n    if (this.settings.isMultiple) {\r\n      this.content.list.setAttribute('aria-multiselectable', 'true')\r\n    }\r\n\r\n    // Search input should also control the listbox\r\n    this.content.search.input.setAttribute('aria-controls', listboxId)\r\n  }\r\n\r\n  public mainDiv(): Main {\r\n    // Create main container\r\n    const main = document.createElement('div')\r\n\r\n    // Add id to data-id\r\n    main.dataset.id = this.settings.id\r\n    // main.id = this.settings.id+'-main' // Remove for now as it is not needed and add duplicate id errors\r\n\r\n    // Add label\r\n    main.setAttribute('aria-label', this.settings.ariaLabel)\r\n\r\n    // Set tabable to allow tabbing to the element\r\n    main.tabIndex = 0\r\n\r\n    // Deal with keyboard events on the main div\r\n    // This is to allow for normal selecting\r\n    // when you may not have a search bar\r\n    main.onkeydown = (e: KeyboardEvent): boolean => {\r\n      // Convert above if else statemets to switch\r\n      switch (e.key) {\r\n        case 'ArrowUp':\r\n        case 'ArrowDown':\r\n          this.callbacks.open()\r\n          e.key === 'ArrowDown' ? this.highlight('down') : this.highlight('up')\r\n          return false\r\n        case 'Tab':\r\n          this.callbacks.close()\r\n          return true // Continue doing normal tabbing\r\n        case 'Enter':\r\n        case ' ':\r\n          this.callbacks.open()\r\n          const highlighted = this.content.list.querySelector(\r\n            '.' + this.classes.getFirst('highlighted')\r\n          ) as HTMLDivElement\r\n          if (highlighted) {\r\n            highlighted.click()\r\n          }\r\n          return false\r\n        case 'Escape':\r\n          this.callbacks.close()\r\n          return false\r\n      }\r\n\r\n      // Check if they type a-z, A-Z and 0-9\r\n      if (e.key.length === 1) {\r\n        this.callbacks.open()\r\n      }\r\n\r\n      return true\r\n    }\r\n\r\n    // Add onclick for main div\r\n    main.onclick = (e: Event): void => {\r\n      // Dont do anything if disabled\r\n      if (this.settings.disabled) {\r\n        return\r\n      }\r\n\r\n      this.settings.isOpen ? this.callbacks.close() : this.callbacks.open()\r\n    }\r\n\r\n    // Add values\r\n    const values = document.createElement('div')\r\n    this.addClasses(values, this.classes.values)\r\n    main.appendChild(values)\r\n\r\n    // Add deselect\r\n    const deselect = document.createElement('div')\r\n    this.addClasses(deselect, this.classes.deselect)\r\n\r\n    // Check if deselect is to be shown or not\r\n    const selectedOptions = this.store?.getSelectedOptions()\r\n    if (!this.settings.allowDeselect || (this.settings.isMultiple && selectedOptions && selectedOptions.length <= 0)) {\r\n      this.addClasses(deselect, this.classes.hide)\r\n    } else {\r\n      this.removeClasses(deselect, this.classes.hide)\r\n    }\r\n\r\n    // Add deselect onclick event\r\n    deselect.onclick = (e: Event) => {\r\n      e.stopPropagation()\r\n\r\n      // Dont do anything if disabled\r\n      if (this.settings.disabled) {\r\n        return\r\n      }\r\n\r\n      // By Default we will delete\r\n      let shouldDelete = true\r\n      const before = this.store.getSelectedOptions()\r\n      const after = [] as Option[]\r\n\r\n      // Add beforeChange callback\r\n      if (this.callbacks.beforeChange) {\r\n        shouldDelete = this.callbacks.beforeChange(after, before) === true\r\n      }\r\n\r\n      if (shouldDelete) {\r\n        if (this.settings.isMultiple) {\r\n          this.callbacks.setSelected([], false)\r\n          this.updateDeselectAll()\r\n        } else {\r\n          // Get first option and set it as selected\r\n          const firstOption = this.store.getFirstOption()\r\n          const id = firstOption ? firstOption.id : ''\r\n\r\n          this.callbacks.setSelected(id, false)\r\n        }\r\n\r\n        // Check if we need to close the dropdown\r\n        if (this.settings.closeOnSelect) {\r\n          this.callbacks.close()\r\n        }\r\n\r\n        // Run afterChange callback\r\n        if (this.callbacks.afterChange) {\r\n          this.callbacks.afterChange(this.store.getSelectedOptions())\r\n        }\r\n      }\r\n    }\r\n\r\n    // Add deselect svg\r\n    const deselectSvg = document.createElementNS('http://www.w3.org/2000/svg', 'svg')\r\n    deselectSvg.setAttribute('viewBox', '0 0 100 100')\r\n    const deselectPath = document.createElementNS('http://www.w3.org/2000/svg', 'path')\r\n    deselectPath.setAttribute('d', this.classes.deselectPath)\r\n    deselectSvg.appendChild(deselectPath)\r\n    deselect.appendChild(deselectSvg)\r\n    main.appendChild(deselect)\r\n\r\n    // Add arrow\r\n    const arrow = document.createElementNS('http://www.w3.org/2000/svg', 'svg')\r\n    this.addClasses(arrow, this.classes.arrow)\r\n    arrow.setAttribute('viewBox', '0 0 100 100')\r\n    const arrowPath = document.createElementNS('http://www.w3.org/2000/svg', 'path')\r\n    arrowPath.setAttribute('d', this.classes.arrowClose)\r\n    if (this.settings.alwaysOpen) {\r\n      this.addClasses(arrow, this.classes.hide)\r\n    }\r\n    arrow.appendChild(arrowPath)\r\n    main.appendChild(arrow)\r\n\r\n    return {\r\n      main: main,\r\n      values: values,\r\n      deselect: {\r\n        main: deselect,\r\n        svg: deselectSvg,\r\n        path: deselectPath\r\n      },\r\n      arrow: {\r\n        main: arrow,\r\n        path: arrowPath\r\n      }\r\n    }\r\n  }\r\n\r\n  public mainFocus(eventType: string | null): void {\r\n    // Trigger focus but dont scroll to it\r\n    // Need for prevent refocus the element if event is not keyboard event.\r\n    // For example if event is mouse click or tachpad click this condition prevent refocus on element\r\n    // because click by mouse change focus position and not need return focus to element.\r\n    if (eventType !== 'click') {\r\n      this.main.main.focus({ preventScroll: true })\r\n    }\r\n  }\r\n\r\n  public placeholder(): HTMLDivElement {\r\n    // Figure out if there is a placeholder option\r\n    const placeholderOption = this.store.filter((o) => o.placeholder, false) as Option[]\r\n\r\n    // If there is a placeholder option use that\r\n    // If placeholder has an html value, use that\r\n    // If placeholder has a text, use that\r\n    // If nothing is set, use the placeholder text\r\n    let placeholderText = this.settings.placeholderText\r\n    if (placeholderOption.length) {\r\n      if (placeholderOption[0].html !== '') {\r\n        placeholderText = placeholderOption[0].html\r\n      } else if (placeholderOption[0].text !== '') {\r\n        placeholderText = placeholderOption[0].text\r\n      }\r\n    }\r\n\r\n    // Create placeholder div\r\n    const placeholder = document.createElement('div')\r\n    this.addClasses(placeholder, this.classes.placeholder)\r\n    placeholder.innerHTML = placeholderText\r\n    return placeholder\r\n  }\r\n\r\n  // Get selected values and append to multiSelected values container\r\n  // and remove those who shouldnt exist\r\n  public renderValues(): void {\r\n    // If single select set placeholder or selected value\r\n    if (!this.settings.isMultiple) {\r\n      this.renderSingleValue()\r\n      return\r\n    }\r\n\r\n    this.renderMultipleValues()\r\n\r\n    this.updateDeselectAll()\r\n  }\r\n\r\n  private renderSingleValue(): void {\r\n    const selected = this.store.filter((o: Option): boolean => {\r\n      return o.selected && !o.placeholder\r\n    }, false) as Option[]\r\n    const selectedSingle = selected.length > 0 ? selected[0] : null\r\n\r\n    // If nothing is seleected use settings placeholder text\r\n    if (!selectedSingle) {\r\n      this.main.values.innerHTML = this.placeholder().outerHTML\r\n    } else {\r\n      // Create single value container\r\n      const singleValue = document.createElement('div')\r\n      this.addClasses(singleValue, this.classes.single)\r\n      if (selectedSingle.html) {\r\n        singleValue.innerHTML = selectedSingle.html\r\n      } else {\r\n        singleValue.innerText = selectedSingle.text\r\n      }\r\n\r\n      // If there is a selected value, set a single div\r\n      this.main.values.innerHTML = singleValue.outerHTML\r\n    }\r\n\r\n    // If allowDeselect is false or selected value is empty just hide deselect\r\n    if (!this.settings.allowDeselect || !selected.length) {\r\n      this.addClasses(this.main.deselect.main, this.classes.hide)\r\n    } else {\r\n      this.removeClasses(this.main.deselect.main, this.classes.hide)\r\n    }\r\n  }\r\n\r\n  private renderMultipleValues(): void {\r\n    // Get various pieces of data\r\n    let currentNodes = this.main.values.childNodes as NodeListOf<HTMLDivElement>\r\n    let selectedOptions = this.store.filter((opt: Option) => {\r\n      // Only grab options that are selected and display is true\r\n      return opt.selected && opt.display\r\n    }, false) as Option[]\r\n\r\n    // If selectedOptions is empty set placeholder\r\n    if (selectedOptions.length === 0) {\r\n      this.main.values.innerHTML = this.placeholder().outerHTML\r\n      return\r\n    } else {\r\n      // If there is a placeholder, remove it\r\n      const placeholder = this.main.values.querySelector('.' + this.classes.getFirst('placeholder'))\r\n      if (placeholder) {\r\n        placeholder.remove()\r\n      }\r\n    }\r\n\r\n    // If selectedOptions is greater than maxItems, set maxValuesMessage\r\n    if (selectedOptions.length > this.settings.maxValuesShown) {\r\n      // Creating the element that shows the number of selected items\r\n      const singleValue = document.createElement('div')\r\n      this.addClasses(singleValue, this.classes.max)\r\n      singleValue.textContent = this.settings.maxValuesMessage.replace('{number}', selectedOptions.length.toString())\r\n\r\n      // If there is a selected value, set a single div\r\n      this.main.values.innerHTML = singleValue.outerHTML\r\n      return\r\n    } else {\r\n      // If there is a message, remove it\r\n      const maxValuesMessage = this.main.values.querySelector('.' + this.classes.getFirst('max'))\r\n      if (maxValuesMessage) {\r\n        maxValuesMessage.remove()\r\n      }\r\n    }\r\n\r\n    // Lets check for data selected order\r\n    if (this.settings.keepOrder) {\r\n      selectedOptions = this.store.selectedOrderOptions(selectedOptions)\r\n    }\r\n\r\n    // Loop through currentNodes and only include ones that are not in selectedIDs\r\n    let removeNodes: HTMLDivElement[] = []\r\n    for (let i = 0; i < currentNodes.length; i++) {\r\n      const node = currentNodes[i]\r\n      const id = node.getAttribute('data-id')\r\n      if (id) {\r\n        // Check if id is in selectedOptions\r\n        const found = selectedOptions.filter((opt: Option) => {\r\n          return opt.id === id\r\n        }, false)\r\n\r\n        // If not found, add to removeNodes\r\n        if (!found.length) {\r\n          removeNodes.push(node)\r\n        }\r\n      }\r\n    }\r\n\r\n    // Loop through and remove\r\n    for (const n of removeNodes) {\r\n      this.addClasses(n, this.classes.valueOut)\r\n      setTimeout(() => {\r\n        if (this.main.values.hasChildNodes() && this.main.values.contains(n)) {\r\n          this.main.values.removeChild(n)\r\n        }\r\n      }, 100)\r\n    }\r\n\r\n    // Add values that dont currently exist\r\n    currentNodes = this.main.values.childNodes as NodeListOf<HTMLDivElement>\r\n    for (let d = 0; d < selectedOptions.length; d++) {\r\n      let shouldAdd = true\r\n      for (let i = 0; i < currentNodes.length; i++) {\r\n        if (selectedOptions[d].id === String(currentNodes[i].dataset.id)) {\r\n          shouldAdd = false\r\n        }\r\n      }\r\n\r\n      // If shouldAdd, insertAdjacentElement it to the values container in the order of the selectedOptions\r\n      if (shouldAdd) {\r\n        // If keepOrder is true, we will just append it to the end\r\n        if (this.settings.keepOrder) {\r\n          this.main.values.appendChild(this.multipleValue(selectedOptions[d]))\r\n        } else {\r\n          // else we will insert it in the order of the selectedOptions\r\n          if (currentNodes.length === 0) {\r\n            this.main.values.appendChild(this.multipleValue(selectedOptions[d]))\r\n          } else if (d === 0) {\r\n            this.main.values.insertBefore(this.multipleValue(selectedOptions[d]), currentNodes[d])\r\n          } else {\r\n            currentNodes[d - 1].insertAdjacentElement('afterend', this.multipleValue(selectedOptions[d]))\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  public multipleValue(option: Option): HTMLDivElement {\r\n    const value = document.createElement('div')\r\n    this.addClasses(value, this.classes.value)\r\n    value.dataset.id = option.id\r\n\r\n    const text = document.createElement('div')\r\n    this.addClasses(text, this.classes.valueText)\r\n    text.textContent = option.text // For multiple values always use text\r\n    value.appendChild(text)\r\n\r\n    // Only add deletion if the option is not mandatory\r\n    if (!option.mandatory) {\r\n      // Create delete div element\r\n      const deleteDiv = document.createElement('div')\r\n      this.addClasses(deleteDiv, this.classes.valueDelete)\r\n      deleteDiv.setAttribute('tabindex', '0') // Make the div focusable for tab navigation\r\n\r\n      // Add delete onclick event\r\n      deleteDiv.onclick = (e: Event) => {\r\n        e.preventDefault()\r\n        e.stopPropagation()\r\n\r\n        // Dont do anything if disabled\r\n        if (this.settings.disabled) {\r\n          return\r\n        }\r\n\r\n        // By Default we will delete\r\n        let shouldDelete = true\r\n        const before = this.store.getSelectedOptions()\r\n        const after = before.filter((o) => {\r\n          return o.selected && o.id !== option.id\r\n        }, true)\r\n\r\n        // Check if minSelected is set and if after length so, return\r\n        if (this.settings.minSelected && after.length < this.settings.minSelected) {\r\n          return\r\n        }\r\n\r\n        // If there is a beforeDeselect function run it\r\n        if (this.callbacks.beforeChange) {\r\n          shouldDelete = this.callbacks.beforeChange(after, before) === true\r\n        }\r\n\r\n        if (shouldDelete) {\r\n          // Loop through after and append ids to a variable called selected\r\n          let selectedIds: string[] = []\r\n          for (const o of after) {\r\n            if (o instanceof Optgroup) {\r\n              for (const c of o.options) {\r\n                if (c.id) {\r\n                  selectedIds.push(c.id)\r\n                }\r\n              }\r\n            }\r\n\r\n            if (o instanceof Option) {\r\n              selectedIds.push(o.id)\r\n            }\r\n          }\r\n          this.callbacks.setSelected(selectedIds, false)\r\n\r\n          // Check if we need to close the dropdown\r\n          if (this.settings.closeOnSelect) {\r\n            this.callbacks.close()\r\n          }\r\n\r\n          // Run afterChange callback\r\n          if (this.callbacks.afterChange) {\r\n            this.callbacks.afterChange(after)\r\n          }\r\n\r\n          this.updateDeselectAll()\r\n        }\r\n      }\r\n\r\n      // Add delete svg\r\n      const deleteSvg = document.createElementNS('http://www.w3.org/2000/svg', 'svg')\r\n      deleteSvg.setAttribute('viewBox', '0 0 100 100')\r\n      const deletePath = document.createElementNS('http://www.w3.org/2000/svg', 'path')\r\n      deletePath.setAttribute('d', this.classes.optionDelete)\r\n      deleteSvg.appendChild(deletePath)\r\n      deleteDiv.appendChild(deleteSvg)\r\n\r\n      value.appendChild(deleteDiv)\r\n\r\n      // Add keydown event listener for keyboard navigation (Enter key)\r\n      deleteDiv.onkeydown = (e) => {\r\n        if (e.key === 'Enter') {\r\n          deleteDiv.click() // Trigger the click event when Enter is pressed\r\n        }\r\n      }\r\n    }\r\n\r\n    return value\r\n  }\r\n\r\n  public contentDiv(): Content {\r\n    const main = document.createElement('div')\r\n\r\n    // Add id to data-id\r\n    main.dataset.id = this.settings.id\r\n    // main.id = this.settings.id + '-content' // Remove for now as it is not needed and add duplicate id errors\r\n\r\n    // Add search\r\n    const search = this.searchDiv()\r\n    main.appendChild(search.main)\r\n\r\n    // Add list\r\n    const list = this.listDiv()\r\n    main.appendChild(list)\r\n\r\n    // Add add-button\r\n    let contentAdd: AddButton | undefined = undefined\r\n    if (this.callbacks.addButton) {\r\n      contentAdd = this.addButtonDiv()\r\n      main.appendChild(contentAdd.main)\r\n    }\r\n\r\n    return {\r\n      main: main,\r\n      search: search,\r\n      list: list,\r\n      addButton: contentAdd\r\n    }\r\n  }\r\n\r\n  // Create content add button element\r\n  public addButtonDiv(): AddButton {\r\n    const main = document.createElement('div')\r\n    this.addClasses(main, this.classes.addButton)\r\n\r\n    const svg = document.createElementNS('http://www.w3.org/2000/svg', 'svg')\r\n    svg.setAttribute('viewBox', '0 0 100 100')\r\n    const path = document.createElementNS('http://www.w3.org/2000/svg', 'path')\r\n    path.setAttribute('d', this.classes.addButtonPath)\r\n    svg.appendChild(path)\r\n    main.appendChild(svg)\r\n\r\n    let textEl: HTMLSpanElement | undefined\r\n    if (this.settings.addButtonText && this.settings.addButtonText !== '') {\r\n      textEl = document.createElement('span')\r\n      textEl.textContent = this.settings.addButtonText\r\n      textEl.className = 'ss-add-button-text'\r\n      main.appendChild(textEl)\r\n    }\r\n\r\n    main.onclick = (e: Event) => {\r\n      e.preventDefault()\r\n      e.stopPropagation()\r\n      if (this.callbacks.addButton) {\r\n        this.callbacks.addButton()\r\n        // Close the dropdown after executing the callback\r\n        this.callbacks.close()\r\n      }\r\n    }\r\n\r\n    return {\r\n      main,\r\n      svg,\r\n      path,\r\n      text: textEl\r\n    }\r\n  }\r\n\r\n  public moveContent(): void {\r\n    // If contentPosition is relative, dont move the content anywhere other than below\r\n    if (this.settings.contentPosition === 'relative') {\r\n      this.moveContentBelow()\r\n      return\r\n    }\r\n\r\n    // If openContent is not auto set content\r\n    if (this.settings.openPosition === 'down') {\r\n      this.moveContentBelow()\r\n      return\r\n    } else if (this.settings.openPosition === 'up') {\r\n      this.moveContentAbove()\r\n      return\r\n    }\r\n\r\n    // Auto - Determine where to put the content\r\n    if (this.putContent() === 'up') {\r\n      this.moveContentAbove()\r\n    } else {\r\n      this.moveContentBelow()\r\n    }\r\n  }\r\n\r\n  public searchDiv(): Search {\r\n    const main = document.createElement('div')\r\n    const input = document.createElement('input')\r\n    const addable = document.createElement('div')\r\n    this.addClasses(main, this.classes.search)\r\n\r\n    // Setup search return object\r\n    const searchReturn: Search = {\r\n      main,\r\n      input\r\n    }\r\n\r\n    // We still want the search to be tabable but not shown\r\n    if (!this.settings.showSearch) {\r\n      this.addClasses(main, this.classes.hide)\r\n      input.readOnly = true\r\n    }\r\n\r\n    input.type = 'search'\r\n    input.placeholder = this.settings.searchPlaceholder\r\n    input.tabIndex = -1\r\n    input.setAttribute('aria-label', this.settings.searchPlaceholder)\r\n    input.setAttribute('aria-autocomplete', 'list')\r\n    input.setAttribute('autocapitalize', 'off')\r\n    input.setAttribute('autocomplete', 'off')\r\n    input.setAttribute('autocorrect', 'off')\r\n    // Hide from screen readers by default (shown when opened)\r\n    input.setAttribute('aria-hidden', 'true')\r\n\r\n    input.oninput = debounce((e: Event) => {\r\n      this.callbacks.search((e.target as HTMLInputElement).value)\r\n    }, 100)\r\n\r\n    // Deal with keyboard events on search input field\r\n    input.onkeydown = (e: KeyboardEvent): boolean => {\r\n      // Convert above if else statemets to switch\r\n      switch (e.key) {\r\n        case 'ArrowUp':\r\n        case 'ArrowDown':\r\n          e.key === 'ArrowDown' ? this.highlight('down') : this.highlight('up')\r\n          return false\r\n        case 'Tab':\r\n          // When tabbing close the dropdown\r\n          // which will also focus on main div\r\n          // and then continuing normal tabbing\r\n          this.callbacks.close()\r\n          return true // Continue doing normal tabbing\r\n        case 'Escape':\r\n          this.callbacks.close()\r\n          return false\r\n        case ' ':\r\n          const highlighted = this.content.list.querySelector(\r\n            '.' + this.classes.getFirst('highlighted')\r\n          ) as HTMLDivElement\r\n          if (highlighted) {\r\n            highlighted.click()\r\n            return false\r\n          }\r\n          return true\r\n        case 'Enter':\r\n          // Check if there's a highlighted option first\r\n          const highlightedEnter = this.content.list.querySelector(\r\n            '.' + this.classes.getFirst('highlighted')\r\n          ) as HTMLDivElement\r\n          if (highlightedEnter) {\r\n            // If an option is highlighted, select it (even if addable is enabled)\r\n            highlightedEnter.click()\r\n            return false\r\n          } else if (this.callbacks.addable) {\r\n            // If no option is highlighted and addable is enabled, add new item\r\n            addable.click()\r\n            return false\r\n          }\r\n          return true\r\n      }\r\n\r\n      return true // Allow normal typing\r\n    }\r\n\r\n    main.appendChild(input)\r\n\r\n    // If addable is enabled, add the addable div\r\n    if (this.callbacks.addable) {\r\n      // Add main class\r\n      this.addClasses(addable, this.classes.addable)\r\n\r\n      // Add svg icon\r\n      const plus = document.createElementNS('http://www.w3.org/2000/svg', 'svg')\r\n      plus.setAttribute('viewBox', '0 0 100 100')\r\n      const plusPath = document.createElementNS('http://www.w3.org/2000/svg', 'path')\r\n      plusPath.setAttribute('d', this.classes.addablePath)\r\n      plus.appendChild(plusPath)\r\n      addable.appendChild(plus)\r\n\r\n      // Add click event to addable div\r\n      addable.onclick = (e: Event) => {\r\n        e.preventDefault()\r\n        e.stopPropagation()\r\n\r\n        // Do nothing if addable is not set\r\n        if (!this.callbacks.addable) {\r\n          return\r\n        }\r\n\r\n        // Grab input value\r\n        const inputValue = this.content.search.input.value.trim()\r\n        if (inputValue === '') {\r\n          this.content.search.input.focus()\r\n          return\r\n        }\r\n\r\n        // Run finish will be ran at the end of the addable function.\r\n        // Reason its in a function is so we can run it after the\r\n        // addable function is done for promise based addables\r\n        const runFinish = (oo: Partial<Option>) => {\r\n          let newOption = new Option(oo)\r\n\r\n          // Call addOption to add the new option\r\n          this.callbacks.addOption(newOption)\r\n\r\n          // set selected value for single and multiple\r\n          if (this.settings.isMultiple) {\r\n            let ids = this.store.getSelected()\r\n            ids.push(newOption.id)\r\n            this.callbacks.setSelected(ids, true)\r\n          } else {\r\n            this.callbacks.setSelected([newOption.id], true)\r\n          }\r\n\r\n          // Clear search\r\n          this.callbacks.search('')\r\n\r\n          // Close it only if closeOnSelect = true\r\n          if (this.settings.closeOnSelect) {\r\n            setTimeout(() => {\r\n              // Give it a little padding for a better looking animation\r\n              this.callbacks.close()\r\n            }, 100)\r\n          }\r\n        }\r\n\r\n        // Call addable callback\r\n        const addableValue = this.callbacks.addable(inputValue)\r\n\r\n        // If addableValue is false, undefined or null, do nothing\r\n        if (addableValue === false || addableValue === undefined || addableValue === null) {\r\n          return\r\n        }\r\n\r\n        // If addableValue is a promise, wait for it to resolve\r\n        if (addableValue instanceof Promise) {\r\n          addableValue.then((value) => {\r\n            if (typeof value === 'string') {\r\n              runFinish({\r\n                text: value,\r\n                value: value\r\n              })\r\n            } else if (addableValue instanceof Error) {\r\n              this.renderError(addableValue.message)\r\n            } else {\r\n              runFinish(value)\r\n            }\r\n          })\r\n        } else if (typeof addableValue === 'string') {\r\n          runFinish({\r\n            text: addableValue,\r\n            value: addableValue\r\n          })\r\n        } else if (addableValue instanceof Error) {\r\n          this.renderError(addableValue.message)\r\n        } else {\r\n          runFinish(addableValue)\r\n        }\r\n\r\n        return\r\n      }\r\n      main.appendChild(addable)\r\n\r\n      // Add the addable to the search return\r\n      searchReturn.addable = {\r\n        main: addable,\r\n        svg: plus,\r\n        path: plusPath\r\n      }\r\n    }\r\n\r\n    return searchReturn\r\n  }\r\n\r\n  public searchFocus(): void {\r\n    this.content.search.input.focus({ preventScroll: true })\r\n  }\r\n\r\n  public getOptions(notPlaceholder = false, notDisabled = false, notHidden = false): HTMLDivElement[] {\r\n    // Put together query string\r\n    let query = '.' + this.classes.getFirst('option')\r\n    if (notPlaceholder) {\r\n      query += ':not(.' + this.classes.getFirst('placeholder') + ')'\r\n    }\r\n    if (notDisabled) {\r\n      query += ':not(.' + this.classes.getFirst('disabled') + ')'\r\n    }\r\n    if (notHidden) {\r\n      query += ':not(.' + this.classes.getFirst('hide') + ')'\r\n    }\r\n\r\n    return Array.from(this.content.list.querySelectorAll(query))\r\n  }\r\n\r\n  // highlightUp is used to highlight the previous option in the list\r\n  public highlight(dir: 'up' | 'down'): void {\r\n    // Get full list of options in list\r\n    const options = this.getOptions(true, true, true)\r\n\r\n    // If there are no options, do nothing\r\n    if (options.length === 0) {\r\n      return\r\n    }\r\n\r\n    // If length is 1, highlight it\r\n    if (options.length === 1) {\r\n      // Check if option doesnt already have highlighted class\r\n      if (!options[0].classList.contains(this.classes.getFirst('highlighted'))) {\r\n        this.addClasses(options[0], this.classes.highlighted)\r\n        return\r\n      }\r\n    }\r\n\r\n    // Loop through options and see if there are no highlighted ones\r\n    let highlighted = false\r\n    for (const o of options) {\r\n      if (o.classList.contains(this.classes.getFirst('highlighted'))) {\r\n        highlighted = true\r\n      }\r\n    }\r\n\r\n    // If no highlighted, see if any are selected and if so highlight selected first one\r\n    if (!highlighted) {\r\n      for (const o of options) {\r\n        if (o.classList.contains(this.classes.getFirst('selected'))) {\r\n          this.addClasses(o, this.classes.highlighted)\r\n          break\r\n        }\r\n      }\r\n    }\r\n\r\n    // Loop through options and find the highlighted one\r\n    for (let i = 0; i < options.length; i++) {\r\n      // Found highlighted option\r\n      if (options[i].classList.contains(this.classes.getFirst('highlighted'))) {\r\n        const prevOption = options[i]\r\n        // Remove highlighted class from current one\r\n        this.removeClasses(prevOption, this.classes.highlighted)\r\n\r\n        // If previous option has parent classes ss-optgroup with ss-open then click it\r\n        const prevParent = prevOption.parentElement\r\n        if (prevParent && prevParent.classList.contains(this.classes.getFirst('mainOpen'))) {\r\n          const optgroupLabel = prevParent.querySelector('.' + this.classes.getFirst('optgroupLabel')) as HTMLDivElement\r\n          if (optgroupLabel) {\r\n            optgroupLabel.click()\r\n          }\r\n        }\r\n\r\n        // Highlight the next one\r\n        let selectOption =\r\n          options[dir === 'down' ? (i + 1 < options.length ? i + 1 : 0) : i - 1 >= 0 ? i - 1 : options.length - 1]\r\n        this.addClasses(selectOption, this.classes.highlighted)\r\n        this.ensureElementInView(this.content.list, selectOption)\r\n\r\n        // Update aria-activedescendant for screen readers\r\n        if (selectOption.id) {\r\n          this.main.main.setAttribute('aria-activedescendant', selectOption.id)\r\n        }\r\n\r\n        // If selected option has parent classes ss-optgroup with ss-close then click it\r\n        const selectParent = selectOption.parentElement\r\n        if (selectParent && selectParent.classList.contains(this.classes.getFirst('close'))) {\r\n          const optgroupLabel = selectParent.querySelector(\r\n            '.' + this.classes.getFirst('optgroupLabel')\r\n          ) as HTMLDivElement\r\n          if (optgroupLabel) {\r\n            optgroupLabel.click()\r\n          }\r\n        }\r\n\r\n        return\r\n      }\r\n    }\r\n\r\n    // If we get here, there is no highlighted option\r\n    // So we will highlight the first or last based upon direction\r\n    const firstHighlight = options[dir === 'down' ? 0 : options.length - 1]\r\n    this.addClasses(firstHighlight, this.classes.highlighted)\r\n\r\n    // Update aria-activedescendant for screen readers\r\n    if (firstHighlight.id) {\r\n      this.main.main.setAttribute('aria-activedescendant', firstHighlight.id)\r\n    }\r\n\r\n    // Scroll to highlighted one\r\n    this.ensureElementInView(this.content.list, firstHighlight)\r\n  }\r\n\r\n  // Create main container that options will reside\r\n  public listDiv(): HTMLDivElement {\r\n    const options = document.createElement('div')\r\n    this.addClasses(options, this.classes.list)\r\n\r\n    // Add id for ARIA controls reference\r\n    const listId = this.settings.id + '-list'\r\n    options.id = listId\r\n    options.dataset.id = listId\r\n\r\n    return options\r\n  }\r\n\r\n  public renderError(error: string) {\r\n    // Clear out innerHtml\r\n    this.content.list.innerHTML = ''\r\n\r\n    const errorDiv = document.createElement('div')\r\n    this.addClasses(errorDiv, this.classes.error)\r\n    errorDiv.textContent = error\r\n    this.content.list.appendChild(errorDiv)\r\n  }\r\n\r\n  public renderSearching() {\r\n    // Clear out innerHtml\r\n    this.content.list.innerHTML = ''\r\n\r\n    const searchingDiv = document.createElement('div')\r\n    this.addClasses(searchingDiv, this.classes.searching)\r\n    searchingDiv.textContent = this.settings.searchingText\r\n    this.content.list.appendChild(searchingDiv)\r\n  }\r\n\r\n  // Take in data and add options to\r\n  public renderOptions(data: (Option | Optgroup)[]): void {\r\n    // Clear out innerHtml\r\n    this.content.list.innerHTML = ''\r\n\r\n    // If no results show no results text\r\n    if (data.length === 0) {\r\n      const noResults = document.createElement('div')\r\n      this.addClasses(noResults, this.classes.search)\r\n\r\n      //\r\n      if (this.callbacks.addable) {\r\n        noResults.innerHTML = this.settings.addableText.replace('{value}', this.content.search.input.value)\r\n      } else {\r\n        noResults.innerHTML = this.settings.searchText\r\n      }\r\n      this.content.list.appendChild(noResults)\r\n      return\r\n    }\r\n\r\n    // If settings has allowDeselect and isSingle, add empty placeholder in the event they want to deselect\r\n    if (this.settings.allowDeselect && !this.settings.isMultiple) {\r\n      // Check if store options have a placeholder\r\n      const placeholderOption = this.store.filter((o) => o.placeholder, false) as Option[]\r\n      if (!placeholderOption.length) {\r\n        this.store.addOption(\r\n          new Option({\r\n            text: '',\r\n            value: '',\r\n            selected: false,\r\n            placeholder: true\r\n          }),\r\n          true\r\n        )\r\n      }\r\n    }\r\n\r\n    // Append individual options to div container\r\n    const fragment = document.createDocumentFragment()\r\n    for (const d of data) {\r\n      // Create optgroup\r\n      if (d instanceof Optgroup) {\r\n        // Create optgroup\r\n        const optgroupEl = document.createElement('div')\r\n        this.addClasses(optgroupEl, this.classes.optgroup)\r\n\r\n        // Create label\r\n        const optgroupLabel = document.createElement('div')\r\n        this.addClasses(optgroupLabel, this.classes.optgroupLabel)\r\n        optgroupEl.appendChild(optgroupLabel)\r\n\r\n        // Create label text div element\r\n        const optgroupLabelText = document.createElement('div')\r\n        this.addClasses(optgroupLabelText, this.classes.optgroupLabelText)\r\n        optgroupLabelText.textContent = d.label\r\n        optgroupLabel.appendChild(optgroupLabelText)\r\n\r\n        // Create options container\r\n        const optgroupActions = document.createElement('div')\r\n        this.addClasses(optgroupActions, this.classes.optgroupActions)\r\n        optgroupLabel.appendChild(optgroupActions)\r\n\r\n        // If selectByGroup is true and isMultiple then add click event to label\r\n        if (this.settings.isMultiple && d.selectAll) {\r\n          // Create new div to hold a checkbox svg\r\n          const selectAll = document.createElement('div')\r\n          this.addClasses(selectAll, this.classes.optgroupSelectAll)\r\n\r\n          // Check options and if all are selected, if so add class selected\r\n          let allSelected = true\r\n          for (const o of d.options) {\r\n            if (!o.selected) {\r\n              allSelected = false\r\n              break\r\n            }\r\n          }\r\n\r\n          // Add class if all selected\r\n          if (allSelected) {\r\n            this.addClasses(selectAll, this.classes.selected)\r\n          }\r\n\r\n          // Add select all text span\r\n          const selectAllText = document.createElement('span')\r\n          selectAllText.textContent = d.selectAllText\r\n          selectAll.appendChild(selectAllText)\r\n\r\n          // Create new svg for checkbox\r\n          const selectAllSvg = document.createElementNS('http://www.w3.org/2000/svg', 'svg')\r\n          selectAllSvg.setAttribute('viewBox', '0 0 100 100')\r\n          selectAll.appendChild(selectAllSvg)\r\n\r\n          // Create new path for box\r\n          const selectAllBox = document.createElementNS('http://www.w3.org/2000/svg', 'path')\r\n          selectAllBox.setAttribute('d', this.classes.optgroupSelectAllBox)\r\n          selectAllSvg.appendChild(selectAllBox)\r\n\r\n          // Create new path for check\r\n          const selectAllCheck = document.createElementNS('http://www.w3.org/2000/svg', 'path')\r\n          selectAllCheck.setAttribute('d', this.classes.optgroupSelectAllCheck)\r\n          selectAllSvg.appendChild(selectAllCheck)\r\n\r\n          // Add click event listener to select all\r\n          selectAll.addEventListener('click', (e: MouseEvent) => {\r\n            e.preventDefault()\r\n            e.stopPropagation()\r\n\r\n            // Get the store current selected values\r\n            const currentSelected = this.store.getSelected()\r\n\r\n            // If all selected, remove all options from selected\r\n            // call setSelected and return\r\n            if (allSelected) {\r\n              // Put together new list minus all options in this optgroup\r\n              const newSelected = currentSelected.filter((s) => {\r\n                for (const o of d.options) {\r\n                  if (s === o.id) {\r\n                    return false\r\n                  }\r\n                }\r\n\r\n                return true\r\n              })\r\n\r\n              this.callbacks.setSelected(newSelected, true)\r\n              return\r\n            } else {\r\n              // Put together new list with all options in this optgroup\r\n              let optionIds = d.options.map((o) => o.id).filter((id) => id !== undefined)\r\n              const newSelected = currentSelected.concat(optionIds)\r\n\r\n              // Loop through options and if they don't exist in the store\r\n              // run addOption callback\r\n              for (const o of d.options) {\r\n                if (o.id && !this.store.getOptionByID(o.id)) {\r\n                  this.callbacks.addOption(new Option(o))\r\n                }\r\n              }\r\n\r\n              this.callbacks.setSelected(newSelected, true)\r\n              return\r\n            }\r\n          })\r\n\r\n          // Append select all to label\r\n          optgroupActions.appendChild(selectAll)\r\n        }\r\n\r\n        // If optgroup has collapsable\r\n        if (d.closable !== 'off') {\r\n          // Create new div to hold a checkbox svg\r\n          const optgroupClosable = document.createElement('div')\r\n          this.addClasses(optgroupClosable, this.classes.optgroupClosable)\r\n\r\n          // Create svg arrow\r\n          const optgroupClosableSvg = document.createElementNS('http://www.w3.org/2000/svg', 'svg')\r\n          optgroupClosableSvg.setAttribute('viewBox', '0 0 100 100')\r\n          this.addClasses(optgroupClosableSvg, this.classes.arrow)\r\n          optgroupClosable.appendChild(optgroupClosableSvg)\r\n\r\n          // Create new path for arrow\r\n          const optgroupClosableArrow = document.createElementNS('http://www.w3.org/2000/svg', 'path')\r\n          optgroupClosableSvg.appendChild(optgroupClosableArrow)\r\n\r\n          // If any options are selected or someone is searching, set optgroup to open\r\n          if (d.options.some((o) => o.selected) || this.content.search.input.value.trim() !== '') {\r\n            this.addClasses(optgroupClosable, this.classes.mainOpen)\r\n            optgroupClosableArrow.setAttribute('d', this.classes.arrowOpen)\r\n          } else if (d.closable === 'open') {\r\n            this.addClasses(optgroupEl, this.classes.mainOpen)\r\n            optgroupClosableArrow.setAttribute('d', this.classes.arrowOpen)\r\n          } else if (d.closable === 'close') {\r\n            this.addClasses(optgroupEl, this.classes.close)\r\n            optgroupClosableArrow.setAttribute('d', this.classes.arrowClose)\r\n          }\r\n\r\n          // Add click event listener to close\r\n          optgroupLabel.addEventListener('click', (e: MouseEvent) => {\r\n            e.preventDefault()\r\n            e.stopPropagation()\r\n\r\n            // If optgroup is closed, open it\r\n            if (optgroupEl.classList.contains(this.classes.getFirst('close'))) {\r\n              this.removeClasses(optgroupEl, this.classes.close)\r\n              this.addClasses(optgroupEl, this.classes.mainOpen)\r\n              optgroupClosableArrow.setAttribute('d', this.classes.arrowOpen)\r\n            } else {\r\n              this.removeClasses(optgroupEl, this.classes.mainOpen)\r\n              this.addClasses(optgroupEl, this.classes.close)\r\n              optgroupClosableArrow.setAttribute('d', this.classes.arrowClose)\r\n            }\r\n          })\r\n\r\n          // Append close to label\r\n          optgroupActions.appendChild(optgroupClosable)\r\n        }\r\n\r\n        // Add optgroup label\r\n        optgroupEl.appendChild(optgroupLabel)\r\n\r\n        // Loop through options\r\n        for (const option of d.options) {\r\n          optgroupEl.appendChild(this.option(new Option(option)))\r\n          fragment.appendChild(optgroupEl)\r\n        }\r\n      }\r\n\r\n      // Create option\r\n      if (d instanceof Option) {\r\n        fragment.appendChild(this.option(d as Option))\r\n      }\r\n    }\r\n\r\n    // Append fragment to list\r\n    this.content.list.appendChild(fragment)\r\n  }\r\n\r\n  // Create option div element\r\n  public option(option: Option): HTMLDivElement {\r\n    // Add hidden placeholder\r\n    if (option.placeholder) {\r\n      const placeholder = document.createElement('div')\r\n      this.addClasses(placeholder, this.classes.option)\r\n      this.addClasses(placeholder, this.classes.hide)\r\n      return placeholder\r\n    }\r\n\r\n    // Create option\r\n    const optionEl = document.createElement('div')\r\n    optionEl.dataset.id = option.id // Dataset id for identifying an option\r\n    optionEl.id = this.settings.id + '-' + option.id // Unique ID for ARIA references\r\n    this.addClasses(optionEl, this.classes.option)\r\n    optionEl.setAttribute('role', 'option') // WCAG attribute\r\n    if (option.class) {\r\n      option.class.split(' ').forEach((dataClass: string) => {\r\n        optionEl.classList.add(dataClass)\r\n      })\r\n    }\r\n    if (option.style) {\r\n      optionEl.style.cssText = option.style\r\n    }\r\n\r\n    // Set option content\r\n    if (this.settings.searchHighlight && this.content.search.input.value.trim() !== '') {\r\n      optionEl.innerHTML = this.highlightText(\r\n        option.html !== '' ? option.html : option.text,\r\n        this.content.search.input.value,\r\n        this.classes.searchHighlighter\r\n      )\r\n    } else if (option.html !== '') {\r\n      optionEl.innerHTML = option.html\r\n    } else {\r\n      optionEl.textContent = option.text\r\n    }\r\n\r\n    // Set title attribute\r\n    if (this.settings.showOptionTooltips && optionEl.textContent) {\r\n      optionEl.setAttribute('title', optionEl.textContent)\r\n    }\r\n\r\n    // If option is disabled\r\n    if (!option.display) {\r\n      this.addClasses(optionEl, this.classes.hide)\r\n    }\r\n\r\n    // If allowed to deselect, null onclick and add disabled\r\n    if (option.disabled) {\r\n      this.addClasses(optionEl, this.classes.disabled)\r\n    }\r\n\r\n    // If option is selected and hideSelectedOption is true, hide it\r\n    if (option.selected && this.settings.hideSelected) {\r\n      this.addClasses(optionEl, this.classes.hide)\r\n    }\r\n\r\n    // If option is selected\r\n    if (option.selected) {\r\n      this.addClasses(optionEl, this.classes.selected)\r\n      optionEl.setAttribute('aria-selected', 'true')\r\n      this.main.main.setAttribute('aria-activedescendant', optionEl.id)\r\n    } else {\r\n      this.removeClasses(optionEl, this.classes.selected)\r\n      optionEl.setAttribute('aria-selected', 'false')\r\n    }\r\n\r\n    // Add click event listener\r\n    optionEl.addEventListener('click', (e: MouseEvent) => {\r\n      e.preventDefault()\r\n      e.stopPropagation()\r\n\r\n      // Setup variables\r\n      const selectedOptions = this.store.getSelected()\r\n      const element = e.currentTarget as HTMLDivElement\r\n      const elementID = String(element.dataset.id)\r\n      const isCmd = e.ctrlKey || e.metaKey // Cmd (Mac) or Ctrl (Windows/Linux)\r\n\r\n      // If the option is disabled, do nothing\r\n      if (option.disabled) {\r\n        return\r\n      }\r\n\r\n      // allowDeselect only applies to single-select mode\r\n      // In multi-select, you can always toggle options on/off\r\n      if (!this.settings.isMultiple && option.selected && !this.settings.allowDeselect) {\r\n        return\r\n      }\r\n\r\n      // Prevent deselection of mandatory options\r\n      if (option.selected && option.mandatory) {\r\n        return\r\n      }\r\n\r\n      // Check limit and do nothing if limit is reached and the option is not selected\r\n      // Also check reverse for min limit and is selected (allow Cmd to bypass minSelected)\r\n      if (\r\n        (this.settings.isMultiple && this.settings.maxSelected <= selectedOptions.length && !option.selected) ||\r\n        (this.settings.isMultiple && this.settings.minSelected >= selectedOptions.length && option.selected && !isCmd)\r\n      ) {\r\n        return\r\n      }\r\n\r\n      // Setup variables\r\n      let shouldUpdate = false\r\n      const before = this.store.getSelectedOptions()\r\n      let after = [] as Option[]\r\n\r\n      // If multiple - mimic native browser multi-select behavior\r\n      if (this.settings.isMultiple) {\r\n        const isCurrentlySelected = before.some((o: Option) => o.id === elementID)\r\n        const isShift = e.shiftKey\r\n\r\n        // Shift+Click: Select range from last clicked to current\r\n        if (isShift && this.lastSelectedOption) {\r\n          const options = this.store.getDataOptions()\r\n          const lastIndex = options.findIndex((o: Option) => o.id === this.lastSelectedOption!.id)\r\n          const currentIndex = options.findIndex((o: Option) => o.id === option.id)\r\n\r\n          if (lastIndex >= 0 && currentIndex >= 0) {\r\n            const startIndex = Math.min(lastIndex, currentIndex)\r\n            const endIndex = Math.max(lastIndex, currentIndex)\r\n            const rangeOptions = options.slice(startIndex, endIndex + 1)\r\n\r\n            // Check if range would exceed maxSelected\r\n            const newSelections = rangeOptions.filter((opt) => !before.find((b) => b.id === opt.id))\r\n            if (before.length + newSelections.length <= this.settings.maxSelected) {\r\n              // Add range to existing selections\r\n              after = before.concat(newSelections)\r\n            } else {\r\n              // Range too large, keep existing selections\r\n              after = before\r\n            }\r\n          } else {\r\n            after = before\r\n          }\r\n        }\r\n        // Cmd/Ctrl+Click: Toggle selection without affecting others (keeps dropdown open)\r\n        else if (isCmd) {\r\n          if (isCurrentlySelected) {\r\n            // Deselect this option\r\n            after = before.filter((o: Option) => o.id !== elementID)\r\n          } else {\r\n            // Add this option to selection\r\n            after = before.concat(option)\r\n          }\r\n          this.lastSelectedOption = option\r\n        }\r\n        // Regular Click: Toggle this option (add/remove), will close dropdown\r\n        else {\r\n          if (isCurrentlySelected) {\r\n            // Deselect this option\r\n            after = before.filter((o: Option) => o.id !== elementID)\r\n          } else {\r\n            // Add this option to selection\r\n            after = before.concat(option)\r\n          }\r\n          this.lastSelectedOption = option\r\n        }\r\n      }\r\n\r\n      // If single\r\n      if (!this.settings.isMultiple) {\r\n        if (option.selected) {\r\n          // If selected after would remove\r\n          after = []\r\n        } else {\r\n          // If not selected after would add\r\n          after = [option]\r\n        }\r\n      }\r\n\r\n      // If no beforeOnChange is set automatically update at end\r\n      if (!this.callbacks.beforeChange) {\r\n        shouldUpdate = true\r\n      }\r\n\r\n      if (this.callbacks.beforeChange) {\r\n        // Check if beforeChange returns false\r\n        if (this.callbacks.beforeChange(after, before) === false) {\r\n          shouldUpdate = false\r\n        } else {\r\n          shouldUpdate = true\r\n        }\r\n      }\r\n\r\n      if (shouldUpdate) {\r\n        // Check if the option exists in the store\r\n        // if not run addOption callback\r\n        if (!this.store.getOptionByID(elementID)) {\r\n          this.callbacks.addOption(option)\r\n        }\r\n\r\n        // Get values from after and set as selected\r\n        this.callbacks.setSelected(\r\n          after.map((o: Option) => o.id),\r\n          false\r\n        )\r\n\r\n        // Close dropdown unless using modifier keys in multi-select\r\n        // (mimics native multi-select behavior where you can keep selecting)\r\n        const isModifierKey = e.ctrlKey || e.metaKey || e.shiftKey // Cmd/Ctrl or Shift\r\n        const shouldClose = this.settings.closeOnSelect && !(this.settings.isMultiple && isModifierKey)\r\n\r\n        if (shouldClose) {\r\n          this.callbacks.close()\r\n        }\r\n\r\n        // callback that the value has changed\r\n        if (this.callbacks.afterChange) {\r\n          this.callbacks.afterChange(after)\r\n        }\r\n      }\r\n    })\r\n\r\n    return optionEl\r\n  }\r\n\r\n  public destroy(): void {\r\n    // Clear any pending timeouts\r\n    if (this.closeAnimationTimeout) {\r\n      clearTimeout(this.closeAnimationTimeout)\r\n      this.closeAnimationTimeout = null\r\n    }\r\n\r\n    // Remove main\r\n    this.main.main.remove()\r\n\r\n    // Remove content\r\n    this.content.main.remove()\r\n  }\r\n\r\n  private highlightText(str: string, search: any, className: string) {\r\n    const searchTerm = search.trim()\r\n    if (searchTerm === '') {\r\n      return str\r\n    }\r\n\r\n    // Escape special regex characters in the search term to prevent regex injection\r\n    const escapedSearch = searchTerm.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&')\r\n\r\n    // Create a temporary div to parse HTML and work with text nodes only\r\n    const tempDiv = document.createElement('div')\r\n    tempDiv.innerHTML = str\r\n\r\n    // Function to recursively process text nodes\r\n    const highlightTextNodes = (node: Node) => {\r\n      if (node.nodeType === Node.TEXT_NODE) {\r\n        const text = node.textContent || ''\r\n        const regex = new RegExp('(' + escapedSearch + ')', 'i')\r\n\r\n        if (regex.test(text)) {\r\n          // Create a temporary container for the highlighted content\r\n          const wrapper = document.createElement('span')\r\n          const parts = text.split(regex)\r\n\r\n          parts.forEach((part, index) => {\r\n            if (part && regex.test(part)) {\r\n              // This is the matched part - wrap it in mark\r\n              const mark = document.createElement('mark')\r\n              mark.className = className\r\n              mark.textContent = part\r\n              wrapper.appendChild(mark)\r\n            } else if (part) {\r\n              // This is not the matched part - keep as text\r\n              wrapper.appendChild(document.createTextNode(part))\r\n            }\r\n          })\r\n\r\n          // Replace the text node with the wrapper\r\n          node.parentNode?.replaceChild(wrapper, node)\r\n        }\r\n      } else if (node.nodeType === Node.ELEMENT_NODE) {\r\n        // Recursively process child nodes\r\n        Array.from(node.childNodes).forEach((child) => highlightTextNodes(child))\r\n      }\r\n    }\r\n\r\n    // Process all text nodes in the temporary div\r\n    Array.from(tempDiv.childNodes).forEach((node) => highlightTextNodes(node))\r\n\r\n    return tempDiv.innerHTML\r\n  }\r\n\r\n  private setContentDirection(direction: 'above' | 'below'): void {\r\n    const isAbove = direction === 'above'\r\n    const addClass = isAbove ? this.classes.dirAbove : this.classes.dirBelow\r\n    const removeClass = isAbove ? this.classes.dirBelow : this.classes.dirAbove\r\n\r\n    // Set direction classes on both main and content\r\n    this.removeClasses(this.main.main, removeClass)\r\n    this.addClasses(this.main.main, addClass)\r\n    this.removeClasses(this.content.main, removeClass)\r\n    this.addClasses(this.content.main, addClass)\r\n\r\n    // Set margin to position content\r\n    if (isAbove) {\r\n      const mainHeight = this.main.main.offsetHeight\r\n      const contentHeight = this.content.main.offsetHeight\r\n      this.content.main.style.margin = '-' + (mainHeight + contentHeight - 1) + 'px 0px 0px 0px'\r\n    } else {\r\n      this.content.main.style.margin = '-1px 0px 0px 0px'\r\n    }\r\n  }\r\n\r\n  private setContentPosition(): void {\r\n    if (this.settings.contentPosition === 'relative') {\r\n      return\r\n    }\r\n\r\n    const containerRect = this.main.main.getBoundingClientRect()\r\n    let top: number\r\n    let left: number\r\n\r\n    if (this.settings.contentPosition === 'fixed') {\r\n      // Fixed positioning - use viewport coordinates directly\r\n      top = containerRect.top + containerRect.height\r\n      left = containerRect.left\r\n    } else {\r\n      // Absolute positioning - calculate relative to offsetParent\r\n      const offsetParent = this.content.main.offsetParent as HTMLElement\r\n      const offsetParentRect = offsetParent ? offsetParent.getBoundingClientRect() : { top: 0, left: 0 }\r\n\r\n      top = containerRect.top - offsetParentRect.top + containerRect.height - (offsetParent?.clientTop || 0)\r\n      left = containerRect.left - offsetParentRect.left - (offsetParent?.clientLeft || 0)\r\n    }\r\n\r\n    this.content.main.style.top = top + 'px'\r\n    this.content.main.style.left = left + 'px'\r\n    this.content.main.style.width = containerRect.width + 'px'\r\n  }\r\n\r\n  public moveContentAbove(): void {\r\n    this.setContentDirection('above')\r\n    this.setContentPosition()\r\n  }\r\n\r\n  public moveContentBelow(): void {\r\n    this.setContentDirection('below')\r\n    this.setContentPosition()\r\n  }\r\n\r\n  public ensureElementInView(container: HTMLElement, element: HTMLElement): void {\r\n    // Determine container top and bottom\r\n    const cTop = container.scrollTop + container.offsetTop // Make sure to have offsetTop\r\n    const cBottom = cTop + container.clientHeight\r\n\r\n    // Determine element top and bottom\r\n    const eTop = element.offsetTop\r\n    const eBottom = eTop + element.clientHeight\r\n\r\n    // Check if out of view\r\n    if (eTop < cTop) {\r\n      container.scrollTop -= cTop - eTop\r\n    } else if (eBottom > cBottom) {\r\n      container.scrollTop += eBottom - cBottom\r\n    }\r\n  }\r\n\r\n  public putContent(): 'up' | 'down' {\r\n    // Get main and content height\r\n    const mainHeight = this.main.main.offsetHeight\r\n    const mainRect = this.main.main.getBoundingClientRect()\r\n    const contentHeight = this.content.main.offsetHeight\r\n\r\n    // From bottom of mainHeight figure out if content will fit below without going below the window\r\n    const spaceBelow = window.innerHeight - (mainRect.top + mainHeight)\r\n\r\n    // If space below is less than content height\r\n    if (spaceBelow <= contentHeight) {\r\n      // If space above is more than content height\r\n      if (mainRect.top > contentHeight) {\r\n        // Move content above\r\n        return 'up'\r\n      } else {\r\n        // Move content below\r\n        return 'down'\r\n      }\r\n    }\r\n\r\n    // Move content below\r\n    return 'down'\r\n  }\r\n\r\n  // Updates deselect based on item count and allowDeselect setting\r\n  public updateDeselectAll(): void {\r\n    if (!this.store || !this.settings) {\r\n      return\r\n    }\r\n    const selected = this.store.getSelectedOptions()\r\n    const hasSelectedItems = selected && selected.length > 0\r\n    const isMultiple = this.settings.isMultiple\r\n    const allowDeselect = this.settings.allowDeselect\r\n\r\n    const deselectButton = this.main.deselect.main\r\n    const hideClass = this.classes.hide\r\n\r\n    if (allowDeselect && !(isMultiple && !hasSelectedItems)) {\r\n      this.removeClasses(deselectButton, hideClass)\r\n    } else {\r\n      this.addClasses(deselectButton, hideClass)\r\n    }\r\n  }\r\n}\r\n","import { kebabCase, hasClassInTree } from './helpers'\r\nimport { Optgroup, Option } from './store'\r\n\r\nexport default class Select {\r\n  public select: HTMLSelectElement\r\n\r\n  // Mutation observer fields\r\n  public onValueChange?: (value: Option[]) => void\r\n  public onClassChange?: (classes: string[]) => void\r\n  public onDisabledChange?: (disabled: boolean) => void\r\n  public onOptionsChange?: (data: (Option | Optgroup)[]) => void\r\n  public onLabelClick?: () => void\r\n\r\n  // Change observers\r\n  private listen: boolean = false\r\n  private observer: MutationObserver | null = null\r\n  private isUpdating: boolean = false\r\n  private pendingOptionsChange: (Option | Optgroup)[] | null = null\r\n\r\n  // Event handlers for preventing native select behavior (especially on iOS Safari)\r\n  private preventNativeSelect: ((e: Event) => void) | null = null\r\n  private preventNativeSelectMousedown: ((e: Event) => void) | null = null\r\n  private preventNativeSelectFocus: ((e: Event) => void) | null = null\r\n\r\n  constructor(select: HTMLSelectElement) {\r\n    this.select = select\r\n\r\n    this.valueChange = this.valueChange.bind(this)\r\n    // Add change event listener\r\n    this.select.addEventListener('change', this.valueChange, {\r\n      // allow bubbling of event\r\n      passive: true\r\n    })\r\n\r\n    // Initiate mutation observer\r\n    this.observer = new MutationObserver(this.observeCall.bind(this))\r\n\r\n    // Start listening for changes\r\n    this.changeListen(true)\r\n  }\r\n\r\n  public enable(): void {\r\n    this.select.disabled = false\r\n  }\r\n\r\n  public disable(): void {\r\n    this.select.disabled = true\r\n  }\r\n\r\n  public hideUI(): void {\r\n    this.select.tabIndex = -1\r\n    // Visually hide but keep focusable for form validation\r\n    // Use 1px dimensions so browser validation popup can display\r\n    this.select.style.position = 'absolute'\r\n    this.select.style.width = '1px'\r\n    this.select.style.height = '1px'\r\n    this.select.style.opacity = '0'\r\n    this.select.style.overflow = 'hidden'\r\n    this.select.style.pointerEvents = 'none'\r\n    // Remove any spacing or borders that could affect layout\r\n    this.select.style.margin = '0'\r\n    this.select.style.padding = '0'\r\n    this.select.style.borderWidth = '0'\r\n    // Clip to completely hide the 1px\r\n    this.select.style.clip = 'rect(0 0 0 0)'\r\n    this.select.setAttribute('aria-hidden', 'true')\r\n\r\n    // Prevent native select from opening when label is clicked (especially on iOS Safari)\r\n    // iOS Safari programmatically focuses/clicks the select when label is clicked,\r\n    // bypassing pointer-events: none, so we need to prevent these events\r\n    // Only add listeners if they haven't been added yet\r\n    if (!this.preventNativeSelect) {\r\n      this.preventNativeSelect = (e: Event) => {\r\n        e.preventDefault()\r\n        e.stopPropagation()\r\n        e.stopImmediatePropagation()\r\n      }\r\n\r\n      this.preventNativeSelectMousedown = (e: Event) => {\r\n        e.preventDefault()\r\n        e.stopPropagation()\r\n        e.stopImmediatePropagation()\r\n      }\r\n\r\n      this.preventNativeSelectFocus = (e: Event) => {\r\n        e.preventDefault()\r\n        e.stopPropagation()\r\n        e.stopImmediatePropagation()\r\n      }\r\n\r\n      // Add event listeners with capture phase to catch events before they reach the select\r\n      this.select.addEventListener('click', this.preventNativeSelect, { capture: true, passive: false })\r\n      this.select.addEventListener('mousedown', this.preventNativeSelectMousedown, { capture: true, passive: false })\r\n      this.select.addEventListener('focus', this.preventNativeSelectFocus, { capture: true, passive: false })\r\n    }\r\n  }\r\n\r\n  public showUI(): void {\r\n    this.select.removeAttribute('tabindex')\r\n    // Reset visual hiding styles\r\n    this.select.style.position = ''\r\n    this.select.style.width = ''\r\n    this.select.style.height = ''\r\n    this.select.style.opacity = ''\r\n    this.select.style.overflow = ''\r\n    this.select.style.pointerEvents = ''\r\n    this.select.style.margin = ''\r\n    this.select.style.padding = ''\r\n    this.select.style.borderWidth = ''\r\n    this.select.style.clip = ''\r\n    this.select.removeAttribute('aria-hidden')\r\n\r\n    // Remove event listeners that prevent native select behavior\r\n    if (this.preventNativeSelect) {\r\n      this.select.removeEventListener('click', this.preventNativeSelect, { capture: true })\r\n      this.preventNativeSelect = null\r\n    }\r\n    if (this.preventNativeSelectMousedown) {\r\n      this.select.removeEventListener('mousedown', this.preventNativeSelectMousedown, { capture: true })\r\n      this.preventNativeSelectMousedown = null\r\n    }\r\n    if (this.preventNativeSelectFocus) {\r\n      this.select.removeEventListener('focus', this.preventNativeSelectFocus, { capture: true })\r\n      this.preventNativeSelectFocus = null\r\n    }\r\n  }\r\n\r\n  public changeListen(listen: boolean) {\r\n    this.listen = listen\r\n\r\n    // Start listening for changes\r\n    if (listen) {\r\n      if (this.observer) {\r\n        this.observer.observe(this.select, {\r\n          subtree: true, // subtree for optgroups options\r\n          childList: true, // children changes\r\n          attributes: true // attributes changes\r\n        })\r\n      }\r\n    }\r\n\r\n    // Stop listening for changes\r\n    if (!listen) {\r\n      if (this.observer) {\r\n        this.observer.disconnect()\r\n      }\r\n    }\r\n  }\r\n\r\n  // This function get triggers when the select value changes\r\n  // and will call the onValueChange function if it exists\r\n  public valueChange(ev: Event): boolean {\r\n    if (this.listen && this.onValueChange) {\r\n      this.onValueChange(this.getSelectedOptions())\r\n    }\r\n\r\n    // Allow bubbling back to other change event listeners\r\n    return true\r\n  }\r\n\r\n  private observeCall(mutations: MutationRecord[]): void {\r\n    // If we are not listening, do nothing.\r\n    if (!this.listen) {\r\n      return\r\n    }\r\n\r\n    let classChanged = false\r\n    let disabledChanged = false\r\n    let optgroupOptionChanged = false\r\n    let selectionChanged = false\r\n\r\n    // Loop through mutations and check various things\r\n    for (const m of mutations) {\r\n      // Check if its the select\r\n      if (m.target === this.select) {\r\n        // Check if disabled has changed\r\n        if (m.attributeName === 'disabled') {\r\n          disabledChanged = true\r\n        }\r\n\r\n        // Check if class has changed\r\n        if (m.attributeName === 'class') {\r\n          classChanged = true\r\n        }\r\n\r\n        if (m.type === 'childList') {\r\n          for (const n of Array.from(m.addedNodes)) {\r\n            if (n.nodeName === 'OPTION' && (<HTMLOptionElement>n).value === this.select.value) {\r\n              // we added a new option that's now the select value\r\n              selectionChanged = true\r\n              break\r\n            }\r\n          }\r\n\r\n          // options changed, so we need the optionsChange event to fire\r\n          optgroupOptionChanged = true\r\n        }\r\n      }\r\n\r\n      // Check if its an optgroup or option\r\n      if (m.target.nodeName === 'OPTGROUP' || m.target.nodeName === 'OPTION') {\r\n        optgroupOptionChanged = true\r\n      }\r\n    }\r\n\r\n    // If class has changed then call the class change function\r\n    if (classChanged && this.onClassChange) {\r\n      this.onClassChange(this.select.className.split(' '))\r\n    }\r\n\r\n    // If disabled has changed then call the disabled change function\r\n    if (disabledChanged && this.onDisabledChange) {\r\n      this.changeListen(false)\r\n      this.onDisabledChange(this.select.disabled)\r\n      this.changeListen(true)\r\n    }\r\n\r\n    // If optgroup or option has changed then call the select change function\r\n    if (optgroupOptionChanged && this.onOptionsChange) {\r\n      // If we're currently updating, queue this change to process after update completes\r\n      if (this.isUpdating) {\r\n        // Only queue if the select element actually has options (not empty from updateOptions clearing)\r\n        // Check the select element directly, not getData() which might return stale data\r\n        if (this.select.options.length > 0) {\r\n          const currentData = this.getData()\r\n          // Only queue if we have actual data\r\n          if (currentData.length > 0) {\r\n            this.pendingOptionsChange = currentData\r\n          }\r\n        }\r\n        if (selectionChanged) {\r\n          this.select.dispatchEvent(new Event('change'))\r\n        }\r\n        return\r\n      }\r\n\r\n      this.changeListen(false)\r\n      this.onOptionsChange(this.getData())\r\n      this.changeListen(true)\r\n    }\r\n\r\n    if (selectionChanged) {\r\n      this.select.dispatchEvent(new Event('change'))\r\n    }\r\n  }\r\n\r\n  // From the select element pull optgroup and options into data\r\n  public getData(): (Option | Optgroup)[] {\r\n    let data = []\r\n\r\n    // Loop through nodes and get data\r\n    const nodes = this.select.childNodes as any as HTMLOptGroupElement[] | HTMLOptionElement[]\r\n    for (const n of nodes) {\r\n      // Optgroup\r\n      if (n.nodeName === 'OPTGROUP') {\r\n        data.push(this.getDataFromOptgroup(n as HTMLOptGroupElement))\r\n      }\r\n\r\n      // Option\r\n      if (n.nodeName === 'OPTION') {\r\n        data.push(this.getDataFromOption(n as HTMLOptionElement))\r\n      }\r\n    }\r\n\r\n    return data\r\n  }\r\n\r\n  public getDataFromOptgroup(optgroup: HTMLOptGroupElement): Optgroup {\r\n    let data = {\r\n      id: optgroup.id,\r\n      label: optgroup.label,\r\n      selectAll: optgroup.dataset ? optgroup.dataset.selectall === 'true' : false,\r\n      selectAllText: optgroup.dataset ? optgroup.dataset.selectalltext : 'Select all',\r\n      closable: optgroup.dataset ? optgroup.dataset.closable : 'off',\r\n      options: []\r\n    } as Optgroup\r\n\r\n    const options = optgroup.childNodes as any as HTMLOptionElement[]\r\n    for (const o of options) {\r\n      if (o.nodeName === 'OPTION') {\r\n        data.options!.push(this.getDataFromOption(o as HTMLOptionElement))\r\n      }\r\n    }\r\n\r\n    return data\r\n  }\r\n\r\n  // From passed in option pull pieces of usable information\r\n  public getDataFromOption(option: HTMLOptionElement): Option {\r\n    return {\r\n      id: option.id,\r\n      value: option.value,\r\n      text: option.text,\r\n      html: option.dataset && option.dataset.html ? option.dataset.html : '',\r\n      defaultSelected: option.defaultSelected,\r\n      selected: option.selected,\r\n      display: option.style.display !== 'none',\r\n      disabled: option.disabled,\r\n      mandatory: option.dataset ? option.dataset.mandatory === 'true' : false,\r\n      placeholder: option.dataset.placeholder === 'true',\r\n      class: option.className,\r\n      style: option.style.cssText,\r\n      data: option.dataset\r\n    } as Option\r\n  }\r\n\r\n  public getSelectedOptions(): Option[] {\r\n    let options = []\r\n\r\n    // Loop through options and set selected\r\n    const opts = this.select.childNodes as any as (HTMLOptGroupElement | HTMLOptionElement)[]\r\n    for (const o of opts) {\r\n      if (o.nodeName === 'OPTGROUP') {\r\n        const optgroupOptions = o.childNodes as any as HTMLOptionElement[]\r\n        for (const oo of optgroupOptions) {\r\n          if (oo.nodeName === 'OPTION') {\r\n            const option = oo as HTMLOptionElement\r\n            if (option.selected) {\r\n              options.push(this.getDataFromOption(option))\r\n            }\r\n          }\r\n        }\r\n      }\r\n\r\n      if (o.nodeName === 'OPTION') {\r\n        const option = o as HTMLOptionElement\r\n        if (option.selected) {\r\n          options.push(this.getDataFromOption(option))\r\n        }\r\n      }\r\n    }\r\n\r\n    return options\r\n  }\r\n\r\n  public getSelectedValues(): string[] {\r\n    return this.getSelectedOptions().map((option) => option.value)\r\n  }\r\n\r\n  public setSelected(ids: string[]): void {\r\n    // Stop listening to changes\r\n    this.changeListen(false)\r\n\r\n    // Loop through options and set selected\r\n    const options = this.select.childNodes as any as (HTMLOptGroupElement | HTMLOptionElement)[]\r\n    for (const o of options) {\r\n      if (o.nodeName === 'OPTGROUP') {\r\n        const optgroup = o as HTMLOptGroupElement\r\n        const optgroupOptions = optgroup.childNodes as any as HTMLOptionElement[]\r\n        for (const oo of optgroupOptions) {\r\n          if (oo.nodeName === 'OPTION') {\r\n            const option = oo as HTMLOptionElement\r\n            option.selected = ids.includes(option.id)\r\n          }\r\n        }\r\n      }\r\n\r\n      if (o.nodeName === 'OPTION') {\r\n        const option = o as HTMLOptionElement\r\n        option.selected = ids.includes(option.id)\r\n      }\r\n    }\r\n\r\n    // Stop listening to changes\r\n    this.changeListen(true)\r\n  }\r\n\r\n  // Set selected options by value instead of id\r\n  // This is useful when the id is not known\r\n  // and only the value is known\r\n  // but the value is not unique and can be duplicated\r\n  public setSelectedByValue(values: string[]): void {\r\n    // Stop listening to changes\r\n    this.changeListen(false)\r\n\r\n    // Loop through options and set selected\r\n    const options = this.select.childNodes as any as (HTMLOptGroupElement | HTMLOptionElement)[]\r\n    for (const o of options) {\r\n      if (o.nodeName === 'OPTGROUP') {\r\n        const optgroup = o as HTMLOptGroupElement\r\n        const optgroupOptions = optgroup.childNodes as any as HTMLOptionElement[]\r\n        for (const oo of optgroupOptions) {\r\n          if (oo.nodeName === 'OPTION') {\r\n            const option = oo as HTMLOptionElement\r\n            option.selected = values.includes(option.value)\r\n          }\r\n        }\r\n      }\r\n\r\n      if (o.nodeName === 'OPTION') {\r\n        const option = o as HTMLOptionElement\r\n        option.selected = values.includes(option.value)\r\n      }\r\n    }\r\n\r\n    // Stop listening to changes\r\n    this.changeListen(true)\r\n  }\r\n\r\n  public updateSelect(id?: string, style?: string, classes?: string[]): void {\r\n    // Stop listening to changes\r\n    this.changeListen(false)\r\n\r\n    // Update id, only if the id isnt already set\r\n    if (id) {\r\n      this.select.dataset.id = id\r\n    }\r\n\r\n    // Update style\r\n    if (style) {\r\n      this.select.style.cssText = style\r\n    }\r\n\r\n    // Update classes\r\n    if (classes) {\r\n      this.select.className = ''\r\n      classes.forEach((c) => {\r\n        if (c.trim() !== '') {\r\n          this.select.classList.add(c.trim())\r\n        }\r\n      })\r\n    }\r\n\r\n    // Start listening to changes\r\n    this.changeListen(true)\r\n  }\r\n\r\n  public updateOptions(data: (Option | Optgroup)[]): void {\r\n    // Don't update if data is empty (prevents clearing select when no data)\r\n    if (!data || data.length === 0) {\r\n      return\r\n    }\r\n\r\n    // Set updating flag FIRST to prevent mutation observer from processing during update\r\n    // This must be set before stopping listening so any queued mutations see the flag\r\n    this.isUpdating = true\r\n    this.pendingOptionsChange = null\r\n\r\n    // Stop listening to changes\r\n    this.changeListen(false)\r\n\r\n    // Clear out select\r\n    this.select.innerHTML = ''\r\n\r\n    for (const d of data) {\r\n      if (d instanceof Optgroup) {\r\n        this.select.appendChild(this.createOptgroup(d))\r\n      }\r\n\r\n      if (d instanceof Option) {\r\n        this.select.appendChild(this.createOption(d))\r\n      }\r\n    }\r\n\r\n    // Trigger change event on original select\r\n    this.select.dispatchEvent(new Event('change', { bubbles: true }))\r\n\r\n    // Start listening to changes\r\n    this.changeListen(true)\r\n\r\n    // Clear updating flag\r\n    this.isUpdating = false\r\n\r\n    // Process any pending options change that was queued during the update\r\n    // Only process if it has data (don't process empty data from innerHTML clearing)\r\n    if (this.pendingOptionsChange !== null) {\r\n      const pending: (Option | Optgroup)[] = this.pendingOptionsChange\r\n      if (pending.length > 0 && this.onOptionsChange) {\r\n        this.pendingOptionsChange = null\r\n        // Process the queued change\r\n        this.changeListen(false)\r\n        this.onOptionsChange(pending)\r\n        this.changeListen(true)\r\n      } else {\r\n        // Clear pending if it was empty\r\n        this.pendingOptionsChange = null\r\n      }\r\n    }\r\n  }\r\n\r\n  public createOptgroup(optgroup: Optgroup): HTMLOptGroupElement {\r\n    const optgroupEl = document.createElement('optgroup')\r\n    optgroupEl.id = optgroup.id\r\n    optgroupEl.label = optgroup.label\r\n    if (optgroup.selectAll) {\r\n      optgroupEl.dataset.selectAll = 'true'\r\n    }\r\n    if (optgroup.closable !== 'off') {\r\n      optgroupEl.dataset.closable = optgroup.closable\r\n    }\r\n    if (optgroup.options) {\r\n      for (const option of optgroup.options) {\r\n        optgroupEl.appendChild(this.createOption(option as Option))\r\n      }\r\n    }\r\n    return optgroupEl\r\n  }\r\n\r\n  public createOption(info: Option): HTMLOptionElement {\r\n    const optionEl = document.createElement('option')\r\n    optionEl.id = info.id\r\n    optionEl.value = info.value\r\n    optionEl.textContent = info.text\r\n    if (info.html !== '') {\r\n      optionEl.setAttribute('data-html', info.html)\r\n    }\r\n    optionEl.defaultSelected = info.defaultSelected\r\n    optionEl.selected = info.selected // Explicitly set selected because defaultSelected: true sets selected to true\r\n    if (info.disabled) {\r\n      optionEl.disabled = true\r\n    }\r\n    if (!info.display) {\r\n      optionEl.style.display = 'none'\r\n    }\r\n    if (info.placeholder) {\r\n      optionEl.setAttribute('data-placeholder', 'true')\r\n    }\r\n    if (info.mandatory) {\r\n      optionEl.setAttribute('data-mandatory', 'true')\r\n    }\r\n    if (info.class) {\r\n      info.class.split(' ').forEach((optionClass: string) => {\r\n        optionEl.classList.add(optionClass)\r\n      })\r\n    }\r\n    if (info.data && typeof info.data === 'object') {\r\n      Object.keys(info.data).forEach((key) => {\r\n        optionEl.setAttribute('data-' + kebabCase(key), info.data[key])\r\n      })\r\n    }\r\n\r\n    return optionEl\r\n  }\r\n\r\n  // Find and handle labels associated with this select\r\n  public setupLabelHandlers(): void {\r\n    const labels: HTMLLabelElement[] = []\r\n\r\n    // Find labels that point to this select via 'for' attribute\r\n    const selectId = this.select.id\r\n    if (selectId) {\r\n      const labelsByFor = document.querySelectorAll<HTMLLabelElement>(`label[for=\"${selectId}\"]`)\r\n      labelsByFor.forEach((label) => labels.push(label))\r\n    }\r\n\r\n    // Find labels that wrap this select (label contains select)\r\n    let parent = this.select.parentElement\r\n    while (parent && parent !== document.body) {\r\n      if (parent.tagName === 'LABEL') {\r\n        labels.push(parent as HTMLLabelElement)\r\n        break\r\n      }\r\n      parent = parent.parentElement\r\n    }\r\n\r\n    // Remove duplicates\r\n    const uniqueLabels = Array.from(new Set(labels))\r\n\r\n    uniqueLabels.forEach((label) => {\r\n      // Skip if already handled\r\n      if ((label as any).__slimSelectLabelHandler) {\r\n        return\r\n      }\r\n\r\n      // Add click handler to label\r\n      const labelClickHandler = (e: MouseEvent) => {\r\n        const target = e.target as HTMLElement\r\n\r\n        // Check if click is on SlimSelect UI elements (main div or content)\r\n        const isSlimSelectElement = hasClassInTree(target, this.select.dataset.id!)\r\n\r\n        // Prevent default label behavior (focusing the select)\r\n        // This needs to happen for all clicks on the label or its children\r\n        // to prevent the browser from focusing the hidden select\r\n        e.preventDefault()\r\n        // e.stopPropagation() // dont stop propagation\r\n\r\n        // Only trigger the toggle if the click is NOT on SlimSelect elements\r\n        // This allows clicking label text/children to toggle, while wrapped SlimSelect handles its own clicks\r\n        if (!isSlimSelectElement && this.onLabelClick) {\r\n          this.onLabelClick()\r\n        }\r\n      }\r\n\r\n      // Store the handler on the label for cleanup later\r\n      ;(label as any).__slimSelectLabelHandler = labelClickHandler\r\n      label.addEventListener('click', labelClickHandler, { capture: true, passive: false })\r\n    })\r\n  }\r\n\r\n  // Remove label handlers\r\n  public removeLabelHandlers(): void {\r\n    const labels: HTMLLabelElement[] = []\r\n\r\n    // Find labels that point to this select via 'for' attribute\r\n    const selectId = this.select.id\r\n    if (selectId) {\r\n      const labelsByFor = document.querySelectorAll<HTMLLabelElement>(`label[for=\"${selectId}\"]`)\r\n      labelsByFor.forEach((label) => labels.push(label))\r\n    }\r\n\r\n    // Find labels that wrap this select\r\n    let parent = this.select.parentElement\r\n    while (parent && parent !== document.body) {\r\n      if (parent.tagName === 'LABEL') {\r\n        labels.push(parent as HTMLLabelElement)\r\n        break\r\n      }\r\n      parent = parent.parentElement\r\n    }\r\n\r\n    // Remove duplicates\r\n    const uniqueLabels = Array.from(new Set(labels))\r\n\r\n    uniqueLabels.forEach((label) => {\r\n      const handler = (label as any).__slimSelectLabelHandler\r\n      if (handler) {\r\n        label.removeEventListener('click', handler, { capture: true })\r\n        delete (label as any).__slimSelectLabelHandler\r\n      }\r\n    })\r\n  }\r\n\r\n  public destroy() {\r\n    this.changeListen(false)\r\n\r\n    // Remove event change listener\r\n    this.select.removeEventListener('change', this.valueChange)\r\n\r\n    // Remove event listeners that prevent native select behavior\r\n    if (this.preventNativeSelect) {\r\n      this.select.removeEventListener('click', this.preventNativeSelect, { capture: true })\r\n      this.preventNativeSelect = null\r\n    }\r\n    if (this.preventNativeSelectMousedown) {\r\n      this.select.removeEventListener('mousedown', this.preventNativeSelectMousedown, { capture: true })\r\n      this.preventNativeSelectMousedown = null\r\n    }\r\n    if (this.preventNativeSelectFocus) {\r\n      this.select.removeEventListener('focus', this.preventNativeSelectFocus, { capture: true })\r\n      this.preventNativeSelectFocus = null\r\n    }\r\n\r\n    // Disconnect observer and null\r\n    if (this.observer) {\r\n      this.observer.disconnect()\r\n      this.observer = null\r\n    }\r\n\r\n    // Remove label handlers\r\n    this.removeLabelHandlers()\r\n\r\n    // Remove dataset id from original select\r\n    delete this.select.dataset.id\r\n\r\n    // Show the original select\r\n    this.showUI()\r\n  }\r\n}\r\n","import { generateID } from './helpers'\r\n\r\nexport default class Settings {\r\n  public id: string = '' // Primary ID for the select\r\n  public style: string = '' // Style attribute from the select element\r\n  public class: string[] = [] // Class attribute from the select element\r\n\r\n  // Dynamic settings\r\n  public isMultiple: boolean = false\r\n  public isOpen: boolean = false\r\n  public isFullOpen: boolean = false\r\n  public intervalMove: ReturnType<typeof setInterval> | null = null\r\n\r\n  // Fields set from constructor\r\n  public disabled: boolean\r\n  public alwaysOpen: boolean\r\n  public showSearch: boolean\r\n  public focusSearch: boolean\r\n  public keepSearch: boolean\r\n  public ariaLabel: string\r\n  public searchPlaceholder: string\r\n  public searchText: string\r\n  public searchingText: string\r\n  public searchHighlight: boolean\r\n  public closeOnSelect: boolean\r\n  public contentLocation: HTMLElement | null\r\n  public contentPosition: 'relative' | 'absolute' | 'fixed'\r\n  public openPosition: 'auto' | 'up' | 'down'\r\n  public placeholderText: string\r\n  public allowDeselect: boolean\r\n  public hideSelected: boolean\r\n  public keepOrder: boolean\r\n  public showOptionTooltips: boolean\r\n  public minSelected: number\r\n  public maxSelected: number\r\n  public timeoutDelay: number\r\n  public maxValuesShown: number\r\n  public maxValuesMessage: string\r\n  public addableText: string\r\n  public addButtonText: string\r\n\r\n  constructor(settings?: Partial<Settings>) {\r\n    if (!settings) {\r\n      settings = {}\r\n    }\r\n\r\n    this.id = 'ss-' + generateID()\r\n    this.style = settings.style || ''\r\n    this.class = settings.class || []\r\n\r\n    this.disabled = settings.disabled !== undefined ? settings.disabled : false\r\n    this.alwaysOpen = settings.alwaysOpen !== undefined ? settings.alwaysOpen : false\r\n    this.showSearch = settings.showSearch !== undefined ? settings.showSearch : true\r\n    this.focusSearch = settings.focusSearch !== undefined ? settings.focusSearch : true\r\n    this.keepSearch = settings.keepSearch !== undefined ? settings.keepSearch : false\r\n    this.ariaLabel = settings.ariaLabel || 'Combobox'\r\n    this.searchPlaceholder = settings.searchPlaceholder || 'Buscar...'\r\n    this.searchText = settings.searchText || 'Sin resultados'\r\n    this.searchingText = settings.searchingText || 'Buscando...'\r\n    this.searchHighlight = settings.searchHighlight !== undefined ? settings.searchHighlight : false\r\n    this.closeOnSelect = settings.closeOnSelect !== undefined ? settings.closeOnSelect : true\r\n    this.contentLocation = settings.contentLocation || document.body\r\n    this.contentPosition = settings.contentPosition || 'absolute'\r\n    this.openPosition = settings.openPosition || 'auto' // options: auto, up, down\r\n    this.placeholderText = settings.placeholderText !== undefined ? settings.placeholderText : 'Seleccionar valor'\r\n    this.allowDeselect = settings.allowDeselect !== undefined ? settings.allowDeselect : false\r\n    this.hideSelected = settings.hideSelected !== undefined ? settings.hideSelected : false\r\n    this.keepOrder = settings.keepOrder !== undefined ? settings.keepOrder : false\r\n    this.showOptionTooltips = settings.showOptionTooltips !== undefined ? settings.showOptionTooltips : false\r\n    this.minSelected = settings.minSelected || 0\r\n    this.maxSelected = settings.maxSelected || 1000\r\n    this.timeoutDelay = settings.timeoutDelay || 200\r\n    this.maxValuesShown = settings.maxValuesShown || 20\r\n    this.maxValuesMessage = settings.maxValuesMessage || '{number} seleccionados'\r\n    this.addableText = settings.addableText || 'Pulsa \"Enter\" para aadir {value}'\r\n    this.addButtonText = settings.addButtonText || ''\r\n  }\r\n}\r\n","import CssClasses from './classes'\r\nimport { debounce, hasClassInTree, isEqual } from './helpers'\r\nimport Render from './render'\r\nimport Select from './select'\r\nimport Settings from './settings'\r\nimport Store, { Option, Optgroup } from './store'\r\n\r\n// Export classes\r\nexport { Settings, Option, Optgroup }\r\n\r\n// Export interfaces from render\r\nexport type { Main, Content, Search } from './render'\r\n\r\nexport interface Config {\r\n  select: string | Element\r\n  data?: (Partial<Option> | Partial<Optgroup>)[]\r\n  settings?: Partial<Settings>\r\n  cssClasses?: Partial<CssClasses>\r\n  events?: Events\r\n}\r\n\r\nexport interface Events {\r\n  search?: (\r\n    searchValue: string,\r\n    currentData: (Option | Optgroup)[]\r\n  ) => Promise<(Partial<Option> | Partial<Optgroup>)[]> | (Partial<Option> | Partial<Optgroup>)[]\r\n  searchFilter?: (option: Option, search: string) => boolean\r\n  addable?: (\r\n    value: string\r\n  ) => Promise<Partial<Option> | string> | Partial<Option> | string | false | null | undefined | Error\r\n  addButton?: () => void\r\n  beforeChange?: (newVal: Option[], oldVal: Option[]) => boolean | void\r\n  afterChange?: (newVal: Option[]) => void\r\n  beforeOpen?: () => void\r\n  afterOpen?: () => void\r\n  beforeClose?: () => void\r\n  afterClose?: () => void\r\n  error?: (err: Error) => void\r\n}\r\n\r\nexport default class SlimSelect {\r\n  public selectEl: HTMLSelectElement\r\n\r\n  // Classes\r\n  public settings!: Settings\r\n  public cssClasses!: CssClasses\r\n  public select!: Select\r\n  public store!: Store\r\n  public render!: Render\r\n\r\n  // Timeout tracking for cleanup\r\n  private openTimeout: ReturnType<typeof setTimeout> | null = null\r\n  private closeTimeout: ReturnType<typeof setTimeout> | null = null\r\n\r\n  // Events\r\n  public events = {\r\n    search: undefined,\r\n    searchFilter: (opt: Option, search: string) => {\r\n      return opt.text.toLowerCase().indexOf(search.toLowerCase()) !== -1\r\n    },\r\n    addable: undefined,\r\n    addButton: undefined,\r\n    beforeChange: undefined,\r\n    afterChange: undefined,\r\n    beforeOpen: undefined,\r\n    afterOpen: undefined,\r\n    beforeClose: undefined,\r\n    afterClose: undefined\r\n  } as Events\r\n\r\n  constructor(config: Config) {\r\n    // Make sure you get the right element\r\n    this.selectEl = (\r\n      typeof config.select === 'string' ? document.querySelector(config.select) : config.select\r\n    ) as HTMLSelectElement\r\n    if (!this.selectEl) {\r\n      if (config.events && config.events.error) {\r\n        config.events.error(new Error('Could not find select element'))\r\n      }\r\n      return\r\n    }\r\n    if (this.selectEl.tagName !== 'SELECT') {\r\n      if (config.events && config.events.error) {\r\n        config.events.error(new Error('Element isnt of type select'))\r\n      }\r\n      return\r\n    }\r\n\r\n    // If select already has a slim select id on it lets destroy it first\r\n    if (this.selectEl.dataset.ssid) {\r\n      this.destroy()\r\n    }\r\n\r\n    // Set settings\r\n    this.settings = new Settings(config.settings)\r\n\r\n    // Set CSS classes\r\n    this.cssClasses = new CssClasses(config.cssClasses)\r\n\r\n    // Set events\r\n    const debounceEvents = ['beforeOpen', 'afterOpen', 'beforeClose', 'afterClose']\r\n    for (const key in config.events) {\r\n      // Check if key exists in events\r\n      if (!config.events.hasOwnProperty(key)) {\r\n        continue\r\n      }\r\n\r\n      // Check if key is in debounceEvents\r\n      if (debounceEvents.indexOf(key) !== -1) {\r\n        ;(this.events as { [key: string]: any })[key] = debounce((config.events as { [key: string]: any })[key], 100)\r\n      } else {\r\n        ;(this.events as { [key: string]: any })[key] = (config.events as { [key: string]: any })[key]\r\n      }\r\n    }\r\n\r\n    // Upate settings with type, style and classname\r\n    this.settings.disabled = config.settings?.disabled ? config.settings.disabled : this.selectEl.disabled\r\n    this.settings.isMultiple = this.selectEl.multiple\r\n    this.settings.style = this.selectEl.style.cssText\r\n    this.settings.class = this.selectEl.className.split(' ')\r\n\r\n    // Set select class\r\n    this.select = new Select(this.selectEl)\r\n    // Ensure the select has an id for label associations\r\n    if (!this.selectEl.id) {\r\n      this.selectEl.id = this.settings.id\r\n    }\r\n    this.select.updateSelect(this.settings.id, this.settings.style, this.settings.class)\r\n    this.select.hideUI() // Hide the original select element\r\n\r\n    // Add select listeners\r\n    this.select.onValueChange = (options: Option[]) => {\r\n      // Run set selected from the values given\r\n      this.setSelected(options.map((option) => option.id))\r\n    }\r\n    this.select.onClassChange = (classes: string[]) => {\r\n      // Update settings with new class\r\n      this.settings.class = classes\r\n\r\n      // Run render updateClassStyles\r\n      this.render.updateClassStyles()\r\n    }\r\n    this.select.onDisabledChange = (disabled: boolean) => {\r\n      if (disabled) {\r\n        this.disable()\r\n      } else {\r\n        this.enable()\r\n      }\r\n    }\r\n    this.select.onOptionsChange = (data: (Option | Optgroup)[]) => {\r\n      // Process the data (including empty data for clearing all options)\r\n      // Empty data is safe to process here because if we were updating, the change would be queued\r\n      // and onOptionsChange wouldn't be called directly\r\n      this.setData(data || [])\r\n    }\r\n    // Set up label click handler to toggle SlimSelect\r\n    // This allows clicking the label to open/close, matching the main div behavior\r\n    this.select.onLabelClick = () => {\r\n      if (!this.settings.disabled) {\r\n        this.settings.isOpen ? this.close() : this.open()\r\n      }\r\n    }\r\n\r\n    // Set store class\r\n    const data = config.data ? config.data : this.select.getData()\r\n    this.store = new Store(this.settings.isMultiple ? 'multiple' : 'single', data)\r\n\r\n    // If data is passed update the original select element\r\n    if (config.data) {\r\n      this.select.updateOptions(this.store.getData())\r\n    }\r\n\r\n    // Set render renderCallbacks\r\n    const renderCallbacks = {\r\n      open: this.open.bind(this),\r\n      close: this.close.bind(this),\r\n      addable: this.events.addable ? this.events.addable : undefined,\r\n      addButton: this.events.addButton ? this.events.addButton : undefined,\r\n      setSelected: this.setSelected.bind(this),\r\n      addOption: this.addOption.bind(this),\r\n      search: this.search.bind(this),\r\n      beforeChange: this.events.beforeChange,\r\n      afterChange: this.events.afterChange\r\n    }\r\n\r\n    // Setup render class\r\n    this.render = new Render(this.settings, this.cssClasses, this.store, renderCallbacks)\r\n    this.render.renderValues()\r\n    this.render.renderOptions(this.store.getData())\r\n\r\n    // Add aria-label or aria-labelledby if exists\r\n    const selectAriaLabel = this.selectEl.getAttribute('aria-label')\r\n    const selectAriaLabelledBy = this.selectEl.getAttribute('aria-labelledby')\r\n\r\n    if (selectAriaLabel) {\r\n      this.render.main.main.setAttribute('aria-label', selectAriaLabel)\r\n    } else if (selectAriaLabelledBy) {\r\n      this.render.main.main.setAttribute('aria-labelledby', selectAriaLabelledBy)\r\n    }\r\n\r\n    // Add render after original select element\r\n    if (this.selectEl.parentNode) {\r\n      this.selectEl.parentNode.insertBefore(this.render.main.main, this.selectEl.nextSibling)\r\n    }\r\n\r\n    // Add window resize listener to moveContent if window size changes\r\n    window.addEventListener('resize', this.windowResize, false)\r\n\r\n    // If the user wants to show the content forcibly on a specific side,\r\n    // there is no need to listen for scroll events\r\n    if (this.settings.openPosition === 'auto') {\r\n      window.addEventListener('scroll', this.windowScroll, false)\r\n    }\r\n\r\n    // Add window visibility change listener to closeContent if window is hidden\r\n    document.addEventListener('visibilitychange', this.windowVisibilityChange)\r\n\r\n    // If disabled lets call it\r\n    if (this.settings.disabled) {\r\n      this.disable()\r\n    }\r\n\r\n    // If alwaysOpnen then open it\r\n    if (this.settings.alwaysOpen) {\r\n      this.open()\r\n    }\r\n\r\n    // Set up label handlers to open SlimSelect when label is clicked\r\n    this.select.setupLabelHandlers()\r\n\r\n    // Add SlimSelect to select element\r\n    ;(this.selectEl as any).slim = this\r\n  }\r\n\r\n  // Set to enabled and remove disabled classes\r\n  public enable(): void {\r\n    this.settings.disabled = false\r\n\r\n    this.select.enable()\r\n    this.render.enable()\r\n  }\r\n\r\n  // Set to disabled and add disabled classes\r\n  public disable(): void {\r\n    this.settings.disabled = true\r\n\r\n    this.select.disable()\r\n    this.render.disable()\r\n  }\r\n\r\n  public getData(): Option[] | Optgroup[] {\r\n    return this.store.getData()\r\n  }\r\n\r\n  public setData(data: (Partial<Option> | Partial<Optgroup>)[]): void {\r\n    // Get original selected values\r\n    const selected = this.store.getSelected()\r\n\r\n    // Validate data\r\n    const err = this.store.validateDataArray(data)\r\n    if (err) {\r\n      if (this.events.error) {\r\n        this.events.error(err)\r\n      }\r\n      return\r\n    }\r\n\r\n    // Update the store\r\n    this.store.setData(data)\r\n    const dataClean = this.store.getData()\r\n\r\n    // Update original select element\r\n    this.select.updateOptions(dataClean)\r\n\r\n    // Update the render\r\n    this.render.renderValues()\r\n    this.render.renderOptions(dataClean)\r\n\r\n    // Trigger afterChange event, if it doesnt equal the original selected values\r\n    if (this.events.afterChange && !isEqual(selected, this.store.getSelected())) {\r\n      this.events.afterChange(this.store.getSelectedOptions())\r\n    }\r\n  }\r\n\r\n  public getSelected(): string[] {\r\n    let options = this.store.getSelectedOptions()\r\n    if (this.settings.keepOrder) {\r\n      options = this.store.selectedOrderOptions(options)\r\n    }\r\n    return options.map((option) => option.value)\r\n  }\r\n\r\n  // Will take in a string or array of strings and set the selected by either the id or value\r\n  public setSelected(values: string | string[], runAfterChange = true): void {\r\n    // Get original selected values\r\n    const selected = this.store.getSelected()\r\n    const options = this.store.getDataOptions()\r\n    values = Array.isArray(values) ? values : [values]\r\n    const ids = []\r\n\r\n    // for back-compatibility support both, set by id and set by value\r\n    for (const value of values) {\r\n      if (options.find((option) => option.id == value)) {\r\n        ids.push(value)\r\n        continue\r\n      }\r\n\r\n      // if option with given id is not found try to search by value\r\n      for (const option of options.filter((option) => option.value == value)) {\r\n        ids.push(option.id)\r\n      }\r\n    }\r\n\r\n    // Update the store\r\n    this.store.setSelectedBy('id', ids)\r\n    const data = this.store.getData()\r\n\r\n    // Update the select element\r\n    this.select.updateOptions(data)\r\n\r\n    // Update the render\r\n    this.render.renderValues()\r\n\r\n    // If there is a search input value lets run through the search again\r\n    // Otherwise we will just render the options from store data\r\n    if (this.render.content.search.input.value !== '') {\r\n      this.search(this.render.content.search.input.value)\r\n    } else {\r\n      this.render.renderOptions(data)\r\n    }\r\n\r\n    // Trigger afterChange event, if it doesnt equal the original selected values\r\n    if (runAfterChange && this.events.afterChange && !isEqual(selected, this.store.getSelected())) {\r\n      this.events.afterChange(this.store.getSelectedOptions())\r\n    }\r\n  }\r\n\r\n  public addOption(option: Partial<Option>): void {\r\n    // Get original selected values\r\n    const selected = this.store.getSelected()\r\n\r\n    // Add option to store if it does not already include the option\r\n    if (!this.store.getDataOptions().some((o) => o.value === (option.value ?? option.text))) {\r\n      this.store.addOption(option)\r\n    }\r\n    const data = this.store.getData()\r\n\r\n    // Update the select element\r\n    this.select.updateOptions(data)\r\n\r\n    // Update the render\r\n    this.render.renderValues()\r\n    this.render.renderOptions(data)\r\n\r\n    // Trigger afterChange event, if it doesnt equal the original selected values\r\n    if (this.events.afterChange && !isEqual(selected, this.store.getSelected())) {\r\n      this.events.afterChange(this.store.getSelectedOptions())\r\n    }\r\n  }\r\n\r\n  public open(): void {\r\n    // Dont open if disabled\r\n    // Dont do anything if the content is already open\r\n    if (this.settings.disabled || this.settings.isOpen) {\r\n      return\r\n    }\r\n\r\n    // Clear any pending close timeout to prevent race conditions\r\n    if (this.closeTimeout) {\r\n      clearTimeout(this.closeTimeout)\r\n      this.closeTimeout = null\r\n    }\r\n\r\n    // Run beforeOpen callback\r\n    if (this.events.beforeOpen) {\r\n      this.events.beforeOpen()\r\n    }\r\n\r\n    // Tell render to open\r\n    this.render.open()\r\n\r\n    // Focus on input field only if search is enabled\r\n    if (this.settings.showSearch && this.settings.focusSearch) {\r\n      this.render.searchFocus()\r\n    }\r\n\r\n    this.settings.isOpen = true\r\n    // setTimeout is for animation completion\r\n    this.openTimeout = setTimeout(() => {\r\n      // Run afterOpen callback\r\n      if (this.events.afterOpen) {\r\n        this.events.afterOpen()\r\n      }\r\n\r\n      // Update settings\r\n      // Prevent overide if user close fast without wait full open\r\n      // For detail see issue https://github.com/brianvoe/slim-select/issues/397\r\n      if (this.settings.isOpen) {\r\n        this.settings.isFullOpen = true\r\n      }\r\n\r\n      // Add onclick listener to document to closeContent if clicked outside\r\n      document.addEventListener('click', this.documentClick)\r\n    }, this.settings.timeoutDelay)\r\n\r\n    // Start an interval to check if main has moved\r\n    // in order to keep content close to main\r\n    if (this.settings.contentPosition === 'absolute') {\r\n      if (this.settings.intervalMove) {\r\n        clearInterval(this.settings.intervalMove)\r\n      }\r\n      this.settings.intervalMove = setInterval(this.render.moveContent.bind(this.render), 500)\r\n    }\r\n  }\r\n\r\n  public close(eventType: string | null = null): void {\r\n    // Dont do anything if the content is already closed\r\n    // Dont do anything if alwaysOpen is true\r\n    if (!this.settings.isOpen || this.settings.alwaysOpen) {\r\n      return\r\n    }\r\n\r\n    // Clear any pending open timeout to prevent race conditions\r\n    if (this.openTimeout) {\r\n      clearTimeout(this.openTimeout)\r\n      this.openTimeout = null\r\n    }\r\n\r\n    // Run beforeClose calback\r\n    if (this.events.beforeClose) {\r\n      this.events.beforeClose()\r\n    }\r\n\r\n    // Tell render to close\r\n    this.render.close()\r\n\r\n    // Clear search only if not empty and keepSearch is false\r\n    if (!this.settings.keepSearch && this.render.content.search.input.value !== '') {\r\n      this.search('') // Clear search\r\n    }\r\n\r\n    // If we arent tabbing focus back on the main element\r\n    this.render.mainFocus(eventType)\r\n\r\n    // Update settings\r\n    this.settings.isOpen = false\r\n    this.settings.isFullOpen = false\r\n\r\n    // Reset the content below\r\n    this.closeTimeout = setTimeout(() => {\r\n      // Run afterClose callback\r\n      if (this.events.afterClose) {\r\n        this.events.afterClose()\r\n      }\r\n\r\n      // Add onclick listener to document to closeContent if clicked outside\r\n      document.removeEventListener('click', this.documentClick)\r\n    }, this.settings.timeoutDelay)\r\n\r\n    if (this.settings.intervalMove) {\r\n      clearInterval(this.settings.intervalMove)\r\n    }\r\n  }\r\n\r\n  // Take in string value and search current options\r\n  public search(value: string): void {\r\n    // If the passed in value is not the same as the search input value\r\n    // then lets update the search input value\r\n    if (this.render.content.search.input.value !== value) {\r\n      this.render.content.search.input.value = value\r\n    }\r\n\r\n    // If value is empty then render all options\r\n    if (value === '') {\r\n      this.render.renderOptions(this.store.getData())\r\n      return\r\n    }\r\n\r\n    // If no search event run regular search\r\n    if (!this.events.search) {\r\n      // If value is empty then render all options\r\n      const searchResults = value === '' ? this.store.getData() : this.store.search(value, this.events.searchFilter!)\r\n      this.render.renderOptions(searchResults)\r\n      return\r\n    }\r\n\r\n    // Search event exists so lets render the searching text\r\n    this.render.renderSearching()\r\n\r\n    // Based upon the search event deal with the response\r\n    const searchResp = this.events.search(value, this.store.getSelectedOptions())\r\n\r\n    // If the search event returns a promise\r\n    if (searchResp instanceof Promise) {\r\n      searchResp\r\n        .then((data: (Partial<Option> | Partial<Optgroup>)[]) => {\r\n          // Update store data with search results, preserving selected options\r\n          this.store.setData(data, true)\r\n\r\n          // Update original select element\r\n          this.select.updateOptions(this.store.getData())\r\n\r\n          // Render the updated data\r\n          this.render.renderOptions(this.store.getData())\r\n        })\r\n        .catch((err: Error | string) => {\r\n          // Update the render with error\r\n          this.render.renderError(typeof err === 'string' ? err : err.message)\r\n        })\r\n\r\n      return\r\n    } else if (Array.isArray(searchResp)) {\r\n      // Update store data with search results, preserving selected options\r\n      this.store.setData(searchResp, true)\r\n\r\n      // Update original select element\r\n      this.select.updateOptions(this.store.getData())\r\n\r\n      // Render the updated data\r\n      this.render.renderOptions(this.store.getData())\r\n    } else {\r\n      // Update the render with error\r\n      this.render.renderError('Search event must return a promise or an array of data')\r\n    }\r\n  }\r\n\r\n  public destroy(): void {\r\n    // Clear any pending timeouts\r\n    if (this.openTimeout) {\r\n      clearTimeout(this.openTimeout)\r\n      this.openTimeout = null\r\n    }\r\n    if (this.closeTimeout) {\r\n      clearTimeout(this.closeTimeout)\r\n      this.closeTimeout = null\r\n    }\r\n    if (this.settings.intervalMove) {\r\n      clearInterval(this.settings.intervalMove)\r\n      this.settings.intervalMove = null\r\n    }\r\n\r\n    // Remove all event listeners\r\n    document.removeEventListener('click', this.documentClick)\r\n    window.removeEventListener('resize', this.windowResize, false)\r\n    if (this.settings.openPosition === 'auto') {\r\n      window.removeEventListener('scroll', this.windowScroll, false)\r\n    }\r\n    document.removeEventListener('visibilitychange', this.windowVisibilityChange)\r\n\r\n    // Delete the store data\r\n    this.store.setData([])\r\n\r\n    // Remove the render\r\n    this.render.destroy()\r\n\r\n    // Show the original select element\r\n    this.select.destroy()\r\n  }\r\n\r\n  private windowResize: (e: Event) => void = debounce(() => {\r\n    if (!this.settings.isOpen && !this.settings.isFullOpen) {\r\n      return\r\n    }\r\n\r\n    this.render.moveContent()\r\n  })\r\n\r\n  // Event listener for window scrolling\r\n  private windowScroll: (e: Event) => void = debounce(() => {\r\n    // If the content is not open, there is no need to move it\r\n    if (!this.settings.isOpen && !this.settings.isFullOpen) {\r\n      return\r\n    }\r\n\r\n    this.render.moveContent()\r\n  })\r\n\r\n  // Event listener for document click\r\n  private documentClick: (e: Event) => void = (e: Event) => {\r\n    // If the content is not open, there is no need to close it\r\n    if (!this.settings.isOpen) {\r\n      return\r\n    }\r\n\r\n    // Check if the click was on the content by looking at the parents\r\n    if (e.target && !hasClassInTree(e.target as HTMLElement, this.settings.id)) {\r\n      this.close(e.type)\r\n    }\r\n  }\r\n\r\n  // Event Listener for window visibility change\r\n  private windowVisibilityChange: (e: Event) => void = () => {\r\n    if (document.hidden) {\r\n      this.close()\r\n    }\r\n  }\r\n}\r\n","// UMD entry point - only exports the default SlimSelect class\r\n// This avoids the mixed exports issue for UMD/IIFE builds\r\nimport SlimSelect, * as namedExports from './index'\r\n\r\n// Attach all named exports as properties on the default export\r\nObject.assign(SlimSelect, namedExports)\r\n\r\nexport default SlimSelect\r\n"],"names":["CssClasses","classes","join","a","b","name","generateID","hasClassInTree","element","className","hasClass","e","c","parentByClass","debounce","func","wait","immediate","timeout","args","context","later","callNow","isEqual","kebabCase","str","result","match","Option","option","Optgroup","optgroup","o","Store","type","data","dataObj","validationError","dataFinal","optOptions","preserveSelected","newData","selectedOptions","missingSelected","selectedOption","found","newItem","opt","addToStart","selectedType","selectedValues","firstOption","hasSelected","selectedObjects","optionValue","selectedIds","value","id","options","search","searchFilter","filter","includeOptgroup","dataSearch","newOrder","isIn","Render","settings","store","callbacks","classValue","cls","dirClass","selectedId","animationTiming","cssValue","listboxId","main","highlighted","values","deselect","shouldDelete","before","after","deselectSvg","deselectPath","arrow","arrowPath","eventType","placeholderOption","placeholderText","placeholder","selected","selectedSingle","singleValue","currentNodes","maxValuesMessage","removeNodes","node","n","d","shouldAdd","i","text","deleteDiv","deleteSvg","deletePath","list","contentAdd","svg","path","textEl","input","addable","searchReturn","highlightedEnter","plus","plusPath","inputValue","runFinish","oo","newOption","ids","addableValue","notPlaceholder","notDisabled","notHidden","query","dir","prevOption","prevParent","optgroupLabel","selectOption","selectParent","firstHighlight","listId","error","errorDiv","searchingDiv","noResults","fragment","optgroupEl","optgroupLabelText","optgroupActions","selectAll","allSelected","selectAllText","selectAllSvg","selectAllBox","selectAllCheck","currentSelected","newSelected","s","optionIds","optgroupClosable","optgroupClosableSvg","optgroupClosableArrow","optionEl","dataClass","elementID","isCmd","shouldUpdate","isCurrentlySelected","lastIndex","currentIndex","startIndex","endIndex","newSelections","isModifierKey","searchTerm","escapedSearch","tempDiv","highlightTextNodes","regex","wrapper","part","index","mark","child","direction","isAbove","addClass","removeClass","mainHeight","contentHeight","containerRect","top","left","offsetParent","offsetParentRect","container","cTop","cBottom","eTop","eBottom","mainRect","hasSelectedItems","isMultiple","allowDeselect","deselectButton","hideClass","Select","select","listen","ev","mutations","classChanged","disabledChanged","optgroupOptionChanged","selectionChanged","m","currentData","nodes","opts","optgroupOptions","style","pending","info","optionClass","key","labels","selectId","label","parent","labelClickHandler","target","isSlimSelectElement","handler","Settings","SlimSelect","config","debounceEvents","disabled","renderCallbacks","selectAriaLabel","selectAriaLabelledBy","err","dataClean","runAfterChange","searchResults","searchResp"],"mappings":"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"}